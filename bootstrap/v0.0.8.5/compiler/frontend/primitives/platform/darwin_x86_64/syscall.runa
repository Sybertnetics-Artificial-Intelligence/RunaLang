Note:
Copyright 2025 Sybertnetics Artificial Intelligence Solutions

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
:End Note

Note:
Darwin x86_64 System Call Implementation

This file implements BSD-style system calls for macOS x86_64.

Platform-specific details:
- OS: Darwin (macOS, iOS simulators)
- Architecture: x86_64 (Intel/AMD 64-bit)
- Syscall convention: BSD-style with RAX = syscall number
- Register usage: RAX (syscall#), RDI, RSI, RDX, R10, R8, R9 (args 1-6), stack (args 7+)
- Syscall instruction: "syscall" (64-bit syscall instruction)

Darwin x86_64 Syscall Convention:
- RAX: Syscall number (BSD syscalls need 0x2000000 mask)
- RDI, RSI, RDX, R10, R8, R9: Arguments 1-6
- Stack: Arguments 7+ (16-byte aligned)
- RAX: Return value (can be negative for errors)

BSD Syscalls vs Mach Syscalls:
- BSD syscalls: Positive numbers + 0x2000000 mask (1, 3, 4, 5, etc.) - POSIX-compatible
- Mach syscalls: Negative numbers (used for Mach kernel services)
- This implementation focuses on BSD syscalls (POSIX interface)

IMPORTANT: Darwin syscall numbers are more stable than Windows but can still
vary between macOS versions. These numbers are for macOS 10.13+ (High Sierra and later).
:End Note

Note: ============================================================================
Note: BSD SYSCALL NUMBER CONSTANTS
Note: ============================================================================
Note: These are BSD-style syscall numbers for macOS x86_64
Note: Source: XNU kernel syscalls.master file

Process called "SYS_EXIT" returns Integer:
    Return 1
End Process

Process called "SYS_FORK" returns Integer:
    Return 2
End Process

Process called "SYS_READ" returns Integer:
    Return 3
End Process

Process called "SYS_WRITE" returns Integer:
    Return 4
End Process

Process called "SYS_OPEN" returns Integer:
    Return 5
End Process

Process called "SYS_CLOSE" returns Integer:
    Return 6
End Process

Process called "SYS_WAIT4" returns Integer:
    Return 7
End Process

Process called "SYS_LINK" returns Integer:
    Return 9
End Process

Process called "SYS_UNLINK" returns Integer:
    Return 10
End Process

Process called "SYS_CHDIR" returns Integer:
    Return 12
End Process

Process called "SYS_FCHDIR" returns Integer:
    Return 13
End Process

Process called "SYS_MKNOD" returns Integer:
    Return 14
End Process

Process called "SYS_CHMOD" returns Integer:
    Return 15
End Process

Process called "SYS_CHOWN" returns Integer:
    Return 16
End Process

Process called "SYS_GETFSSTAT" returns Integer:
    Return 18
End Process

Process called "SYS_GETPID" returns Integer:
    Return 20
End Process

Process called "SYS_SETUID" returns Integer:
    Return 23
End Process

Process called "SYS_GETUID" returns Integer:
    Return 24
End Process

Process called "SYS_GETEUID" returns Integer:
    Return 25
End Process

Process called "SYS_PTRACE" returns Integer:
    Return 26
End Process

Process called "SYS_RECVMSG" returns Integer:
    Return 27
End Process

Process called "SYS_SENDMSG" returns Integer:
    Return 28
End Process

Process called "SYS_RECVFROM" returns Integer:
    Return 29
End Process

Process called "SYS_ACCEPT" returns Integer:
    Return 30
End Process

Process called "SYS_GETPEERNAME" returns Integer:
    Return 31
End Process

Process called "SYS_GETSOCKNAME" returns Integer:
    Return 32
End Process

Process called "SYS_ACCESS" returns Integer:
    Return 33
End Process

Process called "SYS_CHFLAGS" returns Integer:
    Return 34
End Process

Process called "SYS_FCHFLAGS" returns Integer:
    Return 35
End Process

Process called "SYS_SYNC" returns Integer:
    Return 36
End Process

Process called "SYS_KILL" returns Integer:
    Return 37
End Process

Process called "SYS_CROSSARCH_TRAP" returns Integer:
    Return 38
End Process

Process called "SYS_GETPPID" returns Integer:
    Return 39
End Process

Process called "SYS_DUP" returns Integer:
    Return 41
End Process

Process called "SYS_PIPE" returns Integer:
    Return 42
End Process

Process called "SYS_GETEGID" returns Integer:
    Return 43
End Process

Process called "SYS_SIGACTION" returns Integer:
    Return 46
End Process

Process called "SYS_GETGID" returns Integer:
    Return 47
End Process

Process called "SYS_SIGPROCMASK" returns Integer:
    Return 48
End Process

Process called "SYS_GETLOGIN" returns Integer:
    Return 49
End Process

Process called "SYS_SETLOGIN" returns Integer:
    Return 50
End Process

Process called "SYS_ACCT" returns Integer:
    Return 51
End Process

Process called "SYS_SIGPENDING" returns Integer:
    Return 52
End Process

Process called "SYS_SIGALTSTACK" returns Integer:
    Return 53
End Process

Process called "SYS_IOCTL" returns Integer:
    Return 54
End Process

Process called "SYS_REBOOT" returns Integer:
    Return 55
End Process

Process called "SYS_REVOKE" returns Integer:
    Return 56
End Process

Process called "SYS_SYMLINK" returns Integer:
    Return 57
End Process

Process called "SYS_READLINK" returns Integer:
    Return 58
End Process

Process called "SYS_EXECVE" returns Integer:
    Return 59
End Process

Process called "SYS_UMASK" returns Integer:
    Return 60
End Process

Process called "SYS_CHROOT" returns Integer:
    Return 61
End Process

Process called "SYS_MSYNC" returns Integer:
    Return 65
End Process

Process called "SYS_VFORK" returns Integer:
    Return 66
End Process

Process called "SYS_OSLOG_COPROC_REG" returns Integer:
    Return 67
End Process

Process called "SYS_OSLOG_COPROC" returns Integer:
    Return 68
End Process

Process called "SYS_MUNMAP" returns Integer:
    Return 73
End Process

Process called "SYS_MPROTECT" returns Integer:
    Return 74
End Process

Process called "SYS_MADVISE" returns Integer:
    Return 75
End Process

Process called "SYS_MINCORE" returns Integer:
    Return 78
End Process

Process called "SYS_GETGROUPS" returns Integer:
    Return 79
End Process

Process called "SYS_SETGROUPS" returns Integer:
    Return 80
End Process

Process called "SYS_GETPGRP" returns Integer:
    Return 81
End Process

Process called "SYS_SETPGID" returns Integer:
    Return 82
End Process

Process called "SYS_SETITIMER" returns Integer:
    Return 83
End Process

Process called "SYS_SWAPON" returns Integer:
    Return 85
End Process

Process called "SYS_GETITIMER" returns Integer:
    Return 86
End Process

Process called "SYS_GETDTABLESIZE" returns Integer:
    Return 89
End Process

Process called "SYS_DUP2" returns Integer:
    Return 90
End Process

Process called "SYS_FCNTL" returns Integer:
    Return 92
End Process

Process called "SYS_SELECT" returns Integer:
    Return 93
End Process

Process called "SYS_FSYNC" returns Integer:
    Return 95
End Process

Process called "SYS_SETPRIORITY" returns Integer:
    Return 96
End Process

Process called "SYS_SOCKET" returns Integer:
    Return 97
End Process

Process called "SYS_CONNECT" returns Integer:
    Return 98
End Process

Process called "SYS_GETPRIORITY" returns Integer:
    Return 100
End Process

Process called "SYS_BIND" returns Integer:
    Return 104
End Process

Process called "SYS_SETSOCKOPT" returns Integer:
    Return 105
End Process

Process called "SYS_LISTEN" returns Integer:
    Return 106
End Process

Process called "SYS_SIGSUSPEND" returns Integer:
    Return 111
End Process

Process called "SYS_GETTIMEOFDAY" returns Integer:
    Return 116
End Process

Process called "SYS_GETRUSAGE" returns Integer:
    Return 117
End Process

Process called "SYS_GETSOCKOPT" returns Integer:
    Return 118
End Process

Process called "SYS_READV" returns Integer:
    Return 120
End Process

Process called "SYS_WRITEV" returns Integer:
    Return 121
End Process

Process called "SYS_SETTIMEOFDAY" returns Integer:
    Return 122
End Process

Process called "SYS_FCHOWN" returns Integer:
    Return 123
End Process

Process called "SYS_FCHMOD" returns Integer:
    Return 124
End Process

Process called "SYS_SETREUID" returns Integer:
    Return 126
End Process

Process called "SYS_SETREGID" returns Integer:
    Return 127
End Process

Process called "SYS_RENAME" returns Integer:
    Return 128
End Process

Process called "SYS_FLOCK" returns Integer:
    Return 131
End Process

Process called "SYS_MKFIFO" returns Integer:
    Return 132
End Process

Process called "SYS_SENDTO" returns Integer:
    Return 133
End Process

Process called "SYS_SHUTDOWN" returns Integer:
    Return 134
End Process

Process called "SYS_SOCKETPAIR" returns Integer:
    Return 135
End Process

Process called "SYS_MKDIR" returns Integer:
    Return 136
End Process

Process called "SYS_RMDIR" returns Integer:
    Return 137
End Process

Process called "SYS_UTIMES" returns Integer:
    Return 138
End Process

Process called "SYS_FUTIMES" returns Integer:
    Return 139
End Process

Process called "SYS_ADJTIME" returns Integer:
    Return 140
End Process

Process called "SYS_GETHOSTUUID" returns Integer:
    Return 142
End Process

Process called "SYS_SETSID" returns Integer:
    Return 147
End Process

Process called "SYS_GETPGID" returns Integer:
    Return 151
End Process

Process called "SYS_SETPRIVEXEC" returns Integer:
    Return 152
End Process

Process called "SYS_PREAD" returns Integer:
    Return 153
End Process

Process called "SYS_PWRITE" returns Integer:
    Return 154
End Process

Process called "SYS_NFSSVC" returns Integer:
    Return 155
End Process

Process called "SYS_STATFS" returns Integer:
    Return 157
End Process

Process called "SYS_FSTATFS" returns Integer:
    Return 158
End Process

Process called "SYS_UNMOUNT" returns Integer:
    Return 159
End Process

Process called "SYS_GETFH" returns Integer:
    Return 161
End Process

Process called "SYS_QUOTACTL" returns Integer:
    Return 165
End Process

Process called "SYS_MOUNT" returns Integer:
    Return 167
End Process

Process called "SYS_CSOPS" returns Integer:
    Return 169
End Process

Process called "SYS_CSOPS_AUDITTOKEN" returns Integer:
    Return 170
End Process

Process called "SYS_WAITID" returns Integer:
    Return 173
End Process

Process called "SYS_KDEBUG_TYPEFILTER" returns Integer:
    Return 177
End Process

Process called "SYS_KDEBUG_TRACE_STRING" returns Integer:
    Return 178
End Process

Process called "SYS_KDEBUG_TRACE64" returns Integer:
    Return 179
End Process

Process called "SYS_KDEBUG_TRACE" returns Integer:
    Return 180
End Process

Process called "SYS_SETGID" returns Integer:
    Return 181
End Process

Process called "SYS_SETEGID" returns Integer:
    Return 182
End Process

Process called "SYS_SETEUID" returns Integer:
    Return 183
End Process

Process called "SYS_SIGRETURN" returns Integer:
    Return 184
End Process

Process called "SYS_PANIC_WITH_DATA" returns Integer:
    Return 185
End Process

Process called "SYS_THREAD_SELFCOUNTS" returns Integer:
    Return 186
End Process

Process called "SYS_FDATASYNC" returns Integer:
    Return 187
End Process

Process called "SYS_STAT" returns Integer:
    Return 188
End Process

Process called "SYS_FSTAT" returns Integer:
    Return 189
End Process

Process called "SYS_LSTAT" returns Integer:
    Return 190
End Process

Process called "SYS_PATHCONF" returns Integer:
    Return 191
End Process

Process called "SYS_FPATHCONF" returns Integer:
    Return 192
End Process

Process called "SYS_GETRLIMIT" returns Integer:
    Return 194
End Process

Process called "SYS_SETRLIMIT" returns Integer:
    Return 195
End Process

Process called "SYS_GETDIRENTRIES" returns Integer:
    Return 196
End Process

Process called "SYS_MMAP" returns Integer:
    Return 197
End Process

Process called "SYS_LSEEK" returns Integer:
    Return 199
End Process

Process called "SYS_TRUNCATE" returns Integer:
    Return 200
End Process

Process called "SYS_FTRUNCATE" returns Integer:
    Return 201
End Process

Process called "SYS_SYSCTL" returns Integer:
    Return 202
End Process

Process called "SYS_MLOCK" returns Integer:
    Return 203
End Process

Process called "SYS_MUNLOCK" returns Integer:
    Return 204
End Process

Process called "SYS_UNDELETE" returns Integer:
    Return 205
End Process

Process called "SYS_OPEN_DPROTECTED_NP" returns Integer:
    Return 216
End Process

Process called "SYS_FSGETPATH_EXT" returns Integer:
    Return 217
End Process

Process called "SYS_OPENAT_DPROTECTED_NP" returns Integer:
    Return 218
End Process

Process called "SYS_GETATTRLIST" returns Integer:
    Return 220
End Process

Process called "SYS_SETATTRLIST" returns Integer:
    Return 221
End Process

Process called "SYS_GETDIRENTRIESATTR" returns Integer:
    Return 222
End Process

Process called "SYS_EXCHANGEDATA" returns Integer:
    Return 223
End Process

Process called "SYS_SEARCHFS" returns Integer:
    Return 225
End Process

Process called "SYS_DELETE" returns Integer:
    Return 226
End Process

Process called "SYS_COPYFILE" returns Integer:
    Return 227
End Process

Process called "SYS_FGETATTRLIST" returns Integer:
    Return 228
End Process

Process called "SYS_FSETATTRLIST" returns Integer:
    Return 229
End Process

Process called "SYS_POLL" returns Integer:
    Return 230
End Process

Process called "SYS_GETXATTR" returns Integer:
    Return 234
End Process

Process called "SYS_FGETXATTR" returns Integer:
    Return 235
End Process

Process called "SYS_SETXATTR" returns Integer:
    Return 236
End Process

Process called "SYS_FSETXATTR" returns Integer:
    Return 237
End Process

Process called "SYS_REMOVEXATTR" returns Integer:
    Return 238
End Process

Process called "SYS_FREMOVEXATTR" returns Integer:
    Return 239
End Process

Process called "SYS_LISTXATTR" returns Integer:
    Return 240
End Process

Process called "SYS_FLISTXATTR" returns Integer:
    Return 241
End Process

Process called "SYS_FSCTL" returns Integer:
    Return 242
End Process

Process called "SYS_INITGROUPS" returns Integer:
    Return 243
End Process

Process called "SYS_POSIX_SPAWN" returns Integer:
    Return 244
End Process

Process called "SYS_FFSCTL" returns Integer:
    Return 245
End Process

Process called "SYS_FHOPEN" returns Integer:
    Return 248
End Process

Process called "SYS_MINHERIT" returns Integer:
    Return 250
End Process

Process called "SYS_SEMSYS" returns Integer:
    Return 251
End Process

Process called "SYS_MSGSYS" returns Integer:
    Return 252
End Process

Process called "SYS_SHMSYS" returns Integer:
    Return 253
End Process

Process called "SYS_SEMCTL" returns Integer:
    Return 254
End Process

Process called "SYS_SEMGET" returns Integer:
    Return 255
End Process

Process called "SYS_SEMOP" returns Integer:
    Return 256
End Process

Process called "SYS_MSGCTL" returns Integer:
    Return 258
End Process

Process called "SYS_MSGGET" returns Integer:
    Return 259
End Process

Process called "SYS_MSGSND" returns Integer:
    Return 260
End Process

Process called "SYS_MSGRCV" returns Integer:
    Return 261
End Process

Process called "SYS_SHMAT" returns Integer:
    Return 262
End Process

Process called "SYS_SHMCTL" returns Integer:
    Return 263
End Process

Process called "SYS_SHMDT" returns Integer:
    Return 264
End Process

Process called "SYS_SHMGET" returns Integer:
    Return 265
End Process

Process called "SYS_SHM_OPEN" returns Integer:
    Return 266
End Process

Process called "SYS_SHM_UNLINK" returns Integer:
    Return 267
End Process

Process called "SYS_SEM_OPEN" returns Integer:
    Return 268
End Process

Process called "SYS_SEM_CLOSE" returns Integer:
    Return 269
End Process

Process called "SYS_SEM_UNLINK" returns Integer:
    Return 270
End Process

Process called "SYS_SEM_WAIT" returns Integer:
    Return 271
End Process

Process called "SYS_SEM_TRYWAIT" returns Integer:
    Return 272
End Process

Process called "SYS_SEM_POST" returns Integer:
    Return 273
End Process

Process called "SYS_SYSCTLBYNAME" returns Integer:
    Return 274
End Process

Process called "SYS_OPEN_EXTENDED" returns Integer:
    Return 277
End Process

Process called "SYS_UMASK_EXTENDED" returns Integer:
    Return 278
End Process

Process called "SYS_STAT_EXTENDED" returns Integer:
    Return 279
End Process

Process called "SYS_LSTAT_EXTENDED" returns Integer:
    Return 280
End Process

Process called "SYS_FSTAT_EXTENDED" returns Integer:
    Return 281
End Process

Process called "SYS_CHMOD_EXTENDED" returns Integer:
    Return 282
End Process

Process called "SYS_FCHMOD_EXTENDED" returns Integer:
    Return 283
End Process

Process called "SYS_ACCESS_EXTENDED" returns Integer:
    Return 284
End Process

Process called "SYS_SETTID" returns Integer:
    Return 285
End Process

Process called "SYS_GETTID" returns Integer:
    Return 286
End Process

Process called "SYS_SETSGROUPS" returns Integer:
    Return 287
End Process

Process called "SYS_GETSGROUPS" returns Integer:
    Return 288
End Process

Process called "SYS_SETWGROUPS" returns Integer:
    Return 289
End Process

Process called "SYS_GETWGROUPS" returns Integer:
    Return 290
End Process

Process called "SYS_MKFIFO_EXTENDED" returns Integer:
    Return 291
End Process

Process called "SYS_MKDIR_EXTENDED" returns Integer:
    Return 292
End Process

Process called "SYS_IDENTITYSVC" returns Integer:
    Return 293
End Process

Process called "SYS_SHARED_REGION_CHECK_NP" returns Integer:
    Return 294
End Process

Process called "SYS_VM_PRESSURE_MONITOR" returns Integer:
    Return 296
End Process

Process called "SYS_PSYNCH_RW_LONGRDLOCK" returns Integer:
    Return 297
End Process

Process called "SYS_PSYNCH_RW_YIELDWRLOCK" returns Integer:
    Return 298
End Process

Process called "SYS_PSYNCH_RW_DOWNGRADE" returns Integer:
    Return 299
End Process

Process called "SYS_PSYNCH_RW_UPGRADE" returns Integer:
    Return 300
End Process

Process called "SYS_PSYNCH_MUTEXWAIT" returns Integer:
    Return 301
End Process

Process called "SYS_PSYNCH_MUTEXDROP" returns Integer:
    Return 302
End Process

Process called "SYS_PSYNCH_CVBROAD" returns Integer:
    Return 303
End Process

Process called "SYS_PSYNCH_CVSIGNAL" returns Integer:
    Return 304
End Process

Process called "SYS_PSYNCH_CVWAIT" returns Integer:
    Return 305
End Process

Process called "SYS_PSYNCH_RW_RDLOCK" returns Integer:
    Return 306
End Process

Process called "SYS_PSYNCH_RW_WRLOCK" returns Integer:
    Return 307
End Process

Process called "SYS_PSYNCH_RW_UNLOCK" returns Integer:
    Return 308
End Process

Process called "SYS_PSYNCH_RW_UNLOCK2" returns Integer:
    Return 309
End Process

Process called "SYS_GETSID" returns Integer:
    Return 310
End Process

Process called "SYS_SETTID_WITH_PID" returns Integer:
    Return 311
End Process

Process called "SYS_PSYNCH_CVCLRPREPOST" returns Integer:
    Return 312
End Process

Process called "SYS_AIO_FSYNC" returns Integer:
    Return 313
End Process

Process called "SYS_AIO_RETURN" returns Integer:
    Return 314
End Process

Process called "SYS_AIO_SUSPEND" returns Integer:
    Return 315
End Process

Process called "SYS_AIO_CANCEL" returns Integer:
    Return 316
End Process

Process called "SYS_AIO_ERROR" returns Integer:
    Return 317
End Process

Process called "SYS_AIO_READ" returns Integer:
    Return 318
End Process

Process called "SYS_AIO_WRITE" returns Integer:
    Return 319
End Process

Process called "SYS_LIO_LISTIO" returns Integer:
    Return 320
End Process

Process called "SYS_IOPOLICYSYS" returns Integer:
    Return 322
End Process

Process called "SYS_PROCESS_POLICY" returns Integer:
    Return 323
End Process

Process called "SYS_MLOCKALL" returns Integer:
    Return 324
End Process

Process called "SYS_MUNLOCKALL" returns Integer:
    Return 325
End Process

Process called "SYS_ISSETUGID" returns Integer:
    Return 327
End Process

Process called "SYS___PTHREAD_KILL" returns Integer:
    Return 328
End Process

Process called "SYS___PTHREAD_SIGMASK" returns Integer:
    Return 329
End Process

Process called "SYS___SIGWAIT" returns Integer:
    Return 330
End Process

Process called "SYS___DISABLE_THREADSIGNAL" returns Integer:
    Return 331
End Process

Process called "SYS___PTHREAD_MARKCANCEL" returns Integer:
    Return 332
End Process

Process called "SYS___PTHREAD_CANCELED" returns Integer:
    Return 333
End Process

Process called "SYS___SEMWAIT_SIGNAL" returns Integer:
    Return 334
End Process

Process called "SYS_PROC_INFO" returns Integer:
    Return 336
End Process

Process called "SYS_SENDFILE" returns Integer:
    Return 337
End Process

Process called "SYS_STAT64" returns Integer:
    Return 338
End Process

Process called "SYS_FSTAT64" returns Integer:
    Return 339
End Process

Process called "SYS_LSTAT64" returns Integer:
    Return 340
End Process

Process called "SYS_STAT64_EXTENDED" returns Integer:
    Return 341
End Process

Process called "SYS_LSTAT64_EXTENDED" returns Integer:
    Return 342
End Process

Process called "SYS_FSTAT64_EXTENDED" returns Integer:
    Return 343
End Process

Process called "SYS_GETDIRENTRIES64" returns Integer:
    Return 344
End Process

Process called "SYS_STATFS64" returns Integer:
    Return 345
End Process

Process called "SYS_FSTATFS64" returns Integer:
    Return 346
End Process

Process called "SYS_GETFSSTAT64" returns Integer:
    Return 347
End Process

Process called "SYS___PTHREAD_CHDIR" returns Integer:
    Return 348
End Process

Process called "SYS___PTHREAD_FCHDIR" returns Integer:
    Return 349
End Process

Process called "SYS_AUDIT" returns Integer:
    Return 350
End Process

Process called "SYS_AUDITON" returns Integer:
    Return 351
End Process

Process called "SYS_GETAUID" returns Integer:
    Return 353
End Process

Process called "SYS_SETAUID" returns Integer:
    Return 354
End Process

Process called "SYS_GETAUDIT_ADDR" returns Integer:
    Return 357
End Process

Process called "SYS_SETAUDIT_ADDR" returns Integer:
    Return 358
End Process

Process called "SYS_AUDITCTL" returns Integer:
    Return 359
End Process

Process called "SYS_BSDTHREAD_CREATE" returns Integer:
    Return 360
End Process

Process called "SYS_BSDTHREAD_TERMINATE" returns Integer:
    Return 361
End Process

Process called "SYS_KQUEUE" returns Integer:
    Return 362
End Process

Process called "SYS_KEVENT" returns Integer:
    Return 363
End Process

Process called "SYS_LCHOWN" returns Integer:
    Return 364
End Process

Process called "SYS_BSDTHREAD_REGISTER" returns Integer:
    Return 366
End Process

Process called "SYS_WORKQ_OPEN" returns Integer:
    Return 367
End Process

Process called "SYS_WORKQ_KERNRETURN" returns Integer:
    Return 368
End Process

Process called "SYS_KEVENT64" returns Integer:
    Return 369
End Process

Process called "SYS_THREAD_SELFID" returns Integer:
    Return 372
End Process

Process called "SYS_LEDGER" returns Integer:
    Return 373
End Process

Process called "SYS_KEVENT_QOS" returns Integer:
    Return 374
End Process

Process called "SYS_KEVENT_ID" returns Integer:
    Return 375
End Process

Process called "SYS___MAC_EXECVE" returns Integer:
    Return 380
End Process

Process called "SYS___MAC_SYSCALL" returns Integer:
    Return 381
End Process

Process called "SYS___MAC_GET_FILE" returns Integer:
    Return 382
End Process

Process called "SYS___MAC_SET_FILE" returns Integer:
    Return 383
End Process

Process called "SYS___MAC_GET_LINK" returns Integer:
    Return 384
End Process

Process called "SYS___MAC_SET_LINK" returns Integer:
    Return 385
End Process

Process called "SYS___MAC_GET_PROC" returns Integer:
    Return 386
End Process

Process called "SYS___MAC_SET_PROC" returns Integer:
    Return 387
End Process

Process called "SYS___MAC_GET_FD" returns Integer:
    Return 388
End Process

Process called "SYS___MAC_SET_FD" returns Integer:
    Return 389
End Process

Process called "SYS___MAC_GET_PID" returns Integer:
    Return 390
End Process

Process called "SYS_PSELECT" returns Integer:
    Return 394
End Process

Process called "SYS_PSELECT_NOCANCEL" returns Integer:
    Return 395
End Process

Process called "SYS_READ_NOCANCEL" returns Integer:
    Return 396
End Process

Process called "SYS_WRITE_NOCANCEL" returns Integer:
    Return 397
End Process

Process called "SYS_OPEN_NOCANCEL" returns Integer:
    Return 398
End Process

Process called "SYS_CLOSE_NOCANCEL" returns Integer:
    Return 399
End Process

Process called "SYS_WAIT4_NOCANCEL" returns Integer:
    Return 400
End Process

Process called "SYS_RECVMSG_NOCANCEL" returns Integer:
    Return 401
End Process

Process called "SYS_SENDMSG_NOCANCEL" returns Integer:
    Return 402
End Process

Process called "SYS_RECVFROM_NOCANCEL" returns Integer:
    Return 403
End Process

Process called "SYS_ACCEPT_NOCANCEL" returns Integer:
    Return 404
End Process

Process called "SYS_MSYNC_NOCANCEL" returns Integer:
    Return 405
End Process

Process called "SYS_FCNTL_NOCANCEL" returns Integer:
    Return 406
End Process

Process called "SYS_SELECT_NOCANCEL" returns Integer:
    Return 407
End Process

Process called "SYS_FSYNC_NOCANCEL" returns Integer:
    Return 408
End Process

Process called "SYS_CONNECT_NOCANCEL" returns Integer:
    Return 409
End Process

Process called "SYS_SIGSUSPEND_NOCANCEL" returns Integer:
    Return 410
End Process

Process called "SYS_READV_NOCANCEL" returns Integer:
    Return 411
End Process

Process called "SYS_WRITEV_NOCANCEL" returns Integer:
    Return 412
End Process

Process called "SYS_SENDTO_NOCANCEL" returns Integer:
    Return 413
End Process

Process called "SYS_PREAD_NOCANCEL" returns Integer:
    Return 414
End Process

Process called "SYS_PWRITE_NOCANCEL" returns Integer:
    Return 415
End Process

Process called "SYS_WAITID_NOCANCEL" returns Integer:
    Return 416
End Process

Process called "SYS_POLL_NOCANCEL" returns Integer:
    Return 417
End Process

Process called "SYS_MSGSND_NOCANCEL" returns Integer:
    Return 418
End Process

Process called "SYS_MSGRCV_NOCANCEL" returns Integer:
    Return 419
End Process

Process called "SYS_SEM_WAIT_NOCANCEL" returns Integer:
    Return 420
End Process

Process called "SYS_AIO_SUSPEND_NOCANCEL" returns Integer:
    Return 421
End Process

Process called "SYS___SIGWAIT_NOCANCEL" returns Integer:
    Return 422
End Process

Process called "SYS___SEMWAIT_SIGNAL_NOCANCEL" returns Integer:
    Return 423
End Process

Process called "SYS___MAC_MOUNT" returns Integer:
    Return 424
End Process

Process called "SYS___MAC_GET_MOUNT" returns Integer:
    Return 425
End Process

Process called "SYS___MAC_GETFSSTAT" returns Integer:
    Return 426
End Process

Process called "SYS_FSGETPATH" returns Integer:
    Return 427
End Process

Process called "SYS_AUDIT_SESSION_SELF" returns Integer:
    Return 428
End Process

Process called "SYS_AUDIT_SESSION_JOIN" returns Integer:
    Return 429
End Process

Process called "SYS_FILEPORT_MAKEPORT" returns Integer:
    Return 430
End Process

Process called "SYS_FILEPORT_MAKEFD" returns Integer:
    Return 431
End Process

Process called "SYS_AUDIT_SESSION_PORT" returns Integer:
    Return 432
End Process

Process called "SYS_PID_SUSPEND" returns Integer:
    Return 433
End Process

Process called "SYS_PID_RESUME" returns Integer:
    Return 434
End Process

Process called "SYS_PID_HIBERNATE" returns Integer:
    Return 435
End Process

Process called "SYS_PID_SHUTDOWN_SOCKETS" returns Integer:
    Return 436
End Process

Process called "SYS_KAS_INFO" returns Integer:
    Return 439
End Process

Process called "SYS_MEMORYSTATUS_CONTROL" returns Integer:
    Return 440
End Process

Process called "SYS_GUARDED_OPEN_NP" returns Integer:
    Return 441
End Process

Process called "SYS_GUARDED_CLOSE_NP" returns Integer:
    Return 442
End Process

Process called "SYS_GUARDED_KQUEUE_NP" returns Integer:
    Return 443
End Process

Process called "SYS_CHANGE_FDGUARD_NP" returns Integer:
    Return 444
End Process

Process called "SYS_USRCTL" returns Integer:
    Return 445
End Process

Process called "SYS_PROC_RLIMIT_CONTROL" returns Integer:
    Return 446
End Process

Process called "SYS_CONNECTX" returns Integer:
    Return 447
End Process

Process called "SYS_DISCONNECTX" returns Integer:
    Return 448
End Process

Process called "SYS_PEELOFF" returns Integer:
    Return 449
End Process

Process called "SYS_SOCKET_DELEGATE" returns Integer:
    Return 450
End Process

Process called "SYS_TELEMETRY" returns Integer:
    Return 451
End Process

Process called "SYS_PROC_UUID_POLICY" returns Integer:
    Return 452
End Process

Process called "SYS_MEMORYSTATUS_GET_LEVEL" returns Integer:
    Return 453
End Process

Process called "SYS_SYSTEM_OVERRIDE" returns Integer:
    Return 454
End Process

Process called "SYS_VFS_PURGE" returns Integer:
    Return 455
End Process

Process called "SYS_SFI_CTL" returns Integer:
    Return 456
End Process

Process called "SYS_SFI_PIDCTL" returns Integer:
    Return 457
End Process

Process called "SYS_COALITION" returns Integer:
    Return 458
End Process

Process called "SYS_COALITION_INFO" returns Integer:
    Return 459
End Process

Process called "SYS_NECP_MATCH_POLICY" returns Integer:
    Return 460
End Process

Process called "SYS_GETATTRLISTBULK" returns Integer:
    Return 461
End Process

Process called "SYS_CLONEFILEAT" returns Integer:
    Return 462
End Process

Process called "SYS_OPENAT" returns Integer:
    Return 463
End Process

Process called "SYS_OPENAT_NOCANCEL" returns Integer:
    Return 464
End Process

Process called "SYS_RENAMEAT" returns Integer:
    Return 465
End Process

Process called "SYS_FACCESSAT" returns Integer:
    Return 466
End Process

Process called "SYS_FCHMODAT" returns Integer:
    Return 467
End Process

Process called "SYS_FCHOWNAT" returns Integer:
    Return 468
End Process

Process called "SYS_FSTATAT" returns Integer:
    Return 469
End Process

Process called "SYS_FSTATAT64" returns Integer:
    Return 470
End Process

Process called "SYS_LINKAT" returns Integer:
    Return 471
End Process

Process called "SYS_UNLINKAT" returns Integer:
    Return 472
End Process

Process called "SYS_READLINKAT" returns Integer:
    Return 473
End Process

Process called "SYS_SYMLINKAT" returns Integer:
    Return 474
End Process

Process called "SYS_MKDIRAT" returns Integer:
    Return 475
End Process

Process called "SYS_GETATTRLISTAT" returns Integer:
    Return 476
End Process

Process called "SYS_PROC_TRACE_LOG" returns Integer:
    Return 477
End Process

Process called "SYS_BSDTHREAD_CTL" returns Integer:
    Return 478
End Process

Process called "SYS_OPENBYID_NP" returns Integer:
    Return 479
End Process

Process called "SYS_RECVMSG_X" returns Integer:
    Return 480
End Process

Process called "SYS_SENDMSG_X" returns Integer:
    Return 481
End Process

Process called "SYS_THREAD_SELFUSAGE" returns Integer:
    Return 482
End Process

Process called "SYS_CSRCTL" returns Integer:
    Return 483
End Process

Process called "SYS_GUARDED_OPEN_DPROTECTED_NP" returns Integer:
    Return 484
End Process

Process called "SYS_GUARDED_WRITE_NP" returns Integer:
    Return 485
End Process

Process called "SYS_GUARDED_PWRITE_NP" returns Integer:
    Return 486
End Process

Process called "SYS_GUARDED_WRITEV_NP" returns Integer:
    Return 487
End Process

Process called "SYS_RENAMEATX_NP" returns Integer:
    Return 488
End Process

Process called "SYS_MREMAP_ENCRYPTED" returns Integer:
    Return 489
End Process

Process called "SYS_NETAGENT_TRIGGER" returns Integer:
    Return 490
End Process

Process called "SYS_STACK_SNAPSHOT_WITH_CONFIG" returns Integer:
    Return 491
End Process

Process called "SYS_MICROSTACKSHOT" returns Integer:
    Return 492
End Process

Process called "SYS_GRAB_PGO_DATA" returns Integer:
    Return 493
End Process

Process called "SYS_PERSONA" returns Integer:
    Return 494
End Process

Process called "SYS_MACH_EVENTLINK_SIGNAL" returns Integer:
    Return 496
End Process

Process called "SYS_MACH_EVENTLINK_WAIT_UNTIL" returns Integer:
    Return 497
End Process

Process called "SYS_MACH_EVENTLINK_SIGNAL_WAIT_UNTIL" returns Integer:
    Return 498
End Process

Process called "SYS_WORK_INTERVAL_CTL" returns Integer:
    Return 499
End Process

Process called "SYS_GETENTROPY" returns Integer:
    Return 500
End Process

Process called "SYS_NECP_OPEN" returns Integer:
    Return 501
End Process

Process called "SYS_NECP_CLIENT_ACTION" returns Integer:
    Return 502
End Process

Process called "SYS___NEXUS_OPEN" returns Integer:
    Return 503
End Process

Process called "SYS___NEXUS_REGISTER" returns Integer:
    Return 504
End Process

Process called "SYS___NEXUS_DEREGISTER" returns Integer:
    Return 505
End Process

Process called "SYS___NEXUS_CREATE" returns Integer:
    Return 506
End Process

Process called "SYS___NEXUS_DESTROY" returns Integer:
    Return 507
End Process

Process called "SYS___NEXUS_GET_OPT" returns Integer:
    Return 508
End Process

Process called "SYS___NEXUS_SET_OPT" returns Integer:
    Return 509
End Process

Process called "SYS___CHANNEL_OPEN" returns Integer:
    Return 510
End Process

Process called "SYS___CHANNEL_GET_INFO" returns Integer:
    Return 511
End Process

Process called "SYS___CHANNEL_SYNC" returns Integer:
    Return 512
End Process

Process called "SYS___CHANNEL_GET_OPT" returns Integer:
    Return 513
End Process

Process called "SYS___CHANNEL_SET_OPT" returns Integer:
    Return 514
End Process

Process called "SYS_ULOCK_WAIT" returns Integer:
    Return 515
End Process

Process called "SYS_ULOCK_WAKE" returns Integer:
    Return 516
End Process

Process called "SYS_FCLONEFILEAT" returns Integer:
    Return 517
End Process

Process called "SYS_FS_SNAPSHOT" returns Integer:
    Return 518
End Process

Process called "SYS_TERMINATE_WITH_PAYLOAD" returns Integer:
    Return 520
End Process

Process called "SYS_ABORT_WITH_PAYLOAD" returns Integer:
    Return 521
End Process

Process called "SYS_NECP_SESSION_OPEN" returns Integer:
    Return 522
End Process

Process called "SYS_NECP_SESSION_ACTION" returns Integer:
    Return 523
End Process

Process called "SYS_SETATTRLISTAT" returns Integer:
    Return 524
End Process

Process called "SYS_NET_QOS_GUIDELINE" returns Integer:
    Return 525
End Process

Process called "SYS_FMOUNT" returns Integer:
    Return 526
End Process

Process called "SYS_NTP_ADJTIME" returns Integer:
    Return 527
End Process

Process called "SYS_NTP_GETTIME" returns Integer:
    Return 528
End Process

Process called "SYS_OS_FAULT_WITH_PAYLOAD" returns Integer:
    Return 529
End Process

Process called "SYS_KQUEUE_WORKLOOP_CTL" returns Integer:
    Return 530
End Process

Process called "SYS___MACH_BRIDGE_REMOTE_TIME" returns Integer:
    Return 531
End Process

Process called "SYS_COALITION_LEDGER" returns Integer:
    Return 532
End Process

Process called "SYS_LOG_DATA" returns Integer:
    Return 533
End Process

Process called "SYS_MEMORYSTATUS_AVAILABLE_MEMORY" returns Integer:
    Return 534
End Process

Process called "SYS_OBJC_BP_ASSIST_CFG_NP" returns Integer:
    Return 535
End Process

Process called "SYS_SHARED_REGION_MAP_AND_SLIDE_2_NP" returns Integer:
    Return 536
End Process

Process called "SYS_PIVOT_ROOT" returns Integer:
    Return 537
End Process

Process called "SYS_TASK_INSPECT_FOR_PID" returns Integer:
    Return 538
End Process

Process called "SYS_TASK_READ_FOR_PID" returns Integer:
    Return 539
End Process

Process called "SYS_PREADV" returns Integer:
    Return 540
End Process

Process called "SYS_PWRITEV" returns Integer:
    Return 541
End Process

Process called "SYS_PREADV_NOCANCEL" returns Integer:
    Return 542
End Process

Process called "SYS_PWRITEV_NOCANCEL" returns Integer:
    Return 543
End Process

Process called "SYS_ULOCK_WAIT2" returns Integer:
    Return 544
End Process

Process called "SYS_PROC_INFO_EXTENDED_ID" returns Integer:
    Return 545
End Process

Process called "SYS_TRACKER_ACTION" returns Integer:
    Return 546
End Process

Process called "SYS_DEBUG_SYSCALL_REJECT" returns Integer:
    Return 547
End Process

Process called "SYS_DEBUG_SYSCALL_REJECT_CONFIG" returns Integer:
    Return 548
End Process

Process called "SYS_GRAFTDMG" returns Integer:
    Return 549
End Process

Process called "SYS_MAP_WITH_LINKING_NP" returns Integer:
    Return 550
End Process

Process called "SYS_FREADLINK" returns Integer:
    Return 551
End Process

Process called "SYS_RECORD_SYSTEM_EVENT" returns Integer:
    Return 552
End Process

Process called "SYS_MKFIFOAT" returns Integer:
    Return 553
End Process

Process called "SYS_MKNODAT" returns Integer:
    Return 554
End Process

Process called "SYS_UNGRAFTDMG" returns Integer:
    Return 555
End Process

Process called "SYS_COALITION_POLICY_SET" returns Integer:
    Return 556
End Process

Process called "SYS_COALITION_POLICY_GET" returns Integer:
    Return 557
End Process

Note: ============================================================================
Note: GENERIC SYSCALL WRAPPERS
Note: ============================================================================
Note: Darwin x86_64 syscall convention:
Note: - RAX = syscall number (BSD syscalls need 0x2000000 mask)
Note: - RDI, RSI, RDX, R10, R8, R9 = arguments 1-6
Note: - Stack = arguments 7+ (16-byte aligned)
Note: - Return value in RAX

Process called "syscall_0" takes syscall_number as Integer returns Integer:
    Note: Darwin x86_64 syscall with 0 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Execute syscall (Darwin x86_64 uses syscall instruction)
        syscall

        // Store result from RAX
        mov [rbp-16], rax
    End Assembly
    Return result
End Process

Process called "syscall_1" takes syscall_number as Integer, arg1 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 1 argument
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load argument 1 into RDI
        mov rdi, [rbp-16]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-24], rax
    End Assembly
    Return result
End Process

Process called "syscall_2" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 2 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments into RDI, RSI
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-32], rax
    End Assembly
    Return result
End Process

Process called "syscall_3" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 3 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments into RDI, RSI, RDX
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-40], rax
    End Assembly
    Return result
End Process

Process called "syscall_4" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 4 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments into RDI, RSI, RDX, R10
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]
        mov r10, [rbp-40]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-48], rax
    End Assembly
    Return result
End Process

Process called "syscall_5" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 5 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments into RDI, RSI, RDX, R10, R8
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]
        mov r10, [rbp-40]
        mov r8, [rbp-48]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-56], rax
    End Assembly
    Return result
End Process

Process called "syscall_6" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 6 arguments
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments into RDI, RSI, RDX, R10, R8, R9
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]
        mov r10, [rbp-40]
        mov r8, [rbp-48]
        mov r9, [rbp-56]

        // Execute syscall
        syscall

        // Store result from RAX
        mov [rbp-64], rax
    End Assembly
    Return result
End Process

Process called "syscall_7" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer, arg7 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 7 arguments (arg7 passed on stack)
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments 1-6 into registers
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]
        mov r10, [rbp-40]
        mov r8, [rbp-48]
        mov r9, [rbp-56]

        // Argument 7 already on stack at [rbp-64]
        push [rbp-64]

        // Execute syscall
        syscall

        // Clean up stack
        add rsp, 8

        // Store result from RAX
        mov [rbp-72], rax
    End Assembly
    Return result
End Process

Process called "syscall_8" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer, arg7 as Integer, arg8 as Integer returns Integer:
    Note: Darwin x86_64 syscall with 8 arguments (args 7-8 passed on stack)
    Note: Applies BSD syscall class mask (0x2000000) for macOS compatibility
    Let result be 0
    Inline Assembly:
        // Load syscall number into RAX
        mov rax, [rbp-8]

        // Apply BSD syscall class mask (0x2000000)
        or rax, 0x2000000

        // Load arguments 1-6 into registers
        mov rdi, [rbp-16]
        mov rsi, [rbp-24]
        mov rdx, [rbp-32]
        mov r10, [rbp-40]
        mov r8, [rbp-48]
        mov r9, [rbp-56]

        // Arguments 7-8 on stack (reverse order for stack pushing)
        push [rbp-72]
        push [rbp-64]

        // Execute syscall
        syscall

        // Clean up stack
        add rsp, 16

        // Store result from RAX
        mov [rbp-80], rax
    End Assembly
    Return result
End Process

Note: ============================================================================
Note: HIGH-LEVEL BSD SYSCALL WRAPPERS
Note: ============================================================================

Process called "syscall_read" takes fd as Integer, buffer as Integer, count as Integer returns Integer:
    Note: Read from file descriptor
    Let syscall_num be SYS_READ()
    Return syscall_3(syscall_num, fd, buffer, count)
End Process

Process called "syscall_write" takes fd as Integer, buffer as Integer, count as Integer returns Integer:
    Note: Write to file descriptor
    Let syscall_num be SYS_WRITE()
    Return syscall_3(syscall_num, fd, buffer, count)
End Process

Process called "syscall_open" takes filename as Integer, flags as Integer, mode as Integer returns Integer:
    Note: Open a file
    Let syscall_num be SYS_OPEN()
    Return syscall_3(syscall_num, filename, flags, mode)
End Process

Process called "syscall_close" takes fd as Integer returns Integer:
    Note: Close a file descriptor
    Let syscall_num be SYS_CLOSE()
    Return syscall_1(syscall_num, fd)
End Process

Process called "syscall_exit" takes status as Integer returns Integer:
    Note: Exit process immediately
    Let syscall_num be SYS_EXIT()
    Return syscall_1(syscall_num, status)
End Process

Process called "syscall_mmap" takes addr as Integer, length as Integer, prot as Integer, flags as Integer, fd as Integer, offset as Integer returns Integer:
    Note: Map memory region
    Let syscall_num be SYS_MMAP()
    Return syscall_6(syscall_num, addr, length, prot, flags, fd, offset)
End Process

Process called "syscall_munmap" takes addr as Integer, length as Integer returns Integer:
    Note: Unmap memory region
    Let syscall_num be SYS_MUNMAP()
    Return syscall_2(syscall_num, addr, length)
End Process

Process called "syscall_mprotect" takes addr as Integer, length as Integer, prot as Integer returns Integer:
    Note: Change memory protection
    Let syscall_num be SYS_MPROTECT()
    Return syscall_3(syscall_num, addr, length, prot)
End Process

Process called "syscall_getpid" returns Integer:
    Note: Get process ID
    Let syscall_num be SYS_GETPID()
    Return syscall_0(syscall_num)
End Process

Process called "syscall_kill" takes pid as Integer, signal as Integer returns Integer:
    Note: Send signal to process
    Let syscall_num be SYS_KILL()
    Return syscall_2(syscall_num, pid, signal)
End Process

Note: ============================================================================
Note: BSD/POSIX CONSTANTS
Note: ============================================================================

Process called "O_RDONLY" returns Integer:
    Return 0
End Process

Process called "O_WRONLY" returns Integer:
    Return 1
End Process

Process called "O_RDWR" returns Integer:
    Return 2
End Process

Process called "O_CREAT" returns Integer:
    Return 512  Note: 0x200
End Process

Process called "O_TRUNC" returns Integer:
    Return 1024  Note: 0x400
End Process

Process called "O_APPEND" returns Integer:
    Return 8
End Process

Process called "PROT_NONE" returns Integer:
    Return 0
End Process

Process called "PROT_READ" returns Integer:
    Return 1
End Process

Process called "PROT_WRITE" returns Integer:
    Return 2
End Process

Process called "PROT_EXEC" returns Integer:
    Return 4
End Process

Process called "MAP_SHARED" returns Integer:
    Return 1
End Process

Process called "MAP_PRIVATE" returns Integer:
    Return 2
End Process

Process called "MAP_ANONYMOUS" returns Integer:
    Return 4096  Note: 0x1000 on Darwin (MAP_ANON)
End Process

Process called "MAP_FAILED" returns Integer:
    Return -1
End Process

Process called "STDIN_FILENO" returns Integer:
    Return 0
End Process

Process called "STDOUT_FILENO" returns Integer:
    Return 1
End Process

Process called "STDERR_FILENO" returns Integer:
    Return 2
End Process

Process called "SEEK_SET" returns Integer:
    Return 0
End Process

Process called "SEEK_CUR" returns Integer:
    Return 1
End Process

Process called "SEEK_END" returns Integer:
    Return 2
End Process

Note: ============================================================================
Note: HELPER FUNCTIONS
Note: ============================================================================

Process called "is_error" takes result as Integer returns Integer:
    Note: Check if syscall result indicates error
    Note: BSD syscalls return -1 on error, errno not used directly
    If result is less than 0:
        Return 1  Note: Error
    End If
    Return 0  Note: Success
End Process
