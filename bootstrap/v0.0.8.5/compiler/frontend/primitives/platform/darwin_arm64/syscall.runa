Note:
Copyright 2025 Sybertnetics Artificial Intelligence Solutions

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
:End Note

Note:
Darwin ARM64 System Call Implementation

This file implements BSD-style system calls for macOS ARM64.

Platform-specific details:
- OS: Darwin (macOS, iOS, iPadOS, etc.)
- Architecture: ARM64 (AArch64)
- Syscall convention: BSD-style with X16 = syscall number
- Register usage: X16 (syscall#), X0-X7 (args 1-8), stack (args 9+)
- Syscall instruction: "svc #0x80" (supervisor call with BSD flag)

Darwin ARM64 Syscall Convention:
- X16: Syscall number (unlike Linux which uses X8)
- X0-X7: Arguments 1-8 (same as function calling convention)
- Stack: Arguments 9+ (16-byte aligned)
- X0: Return value (can be negative for errors)

BSD Syscalls vs Mach Syscalls:
- BSD syscalls: Positive numbers (1, 3, 4, 5, etc.) - POSIX-compatible
- Mach syscalls: Negative numbers (used for Mach kernel services)
- This implementation focuses on BSD syscalls (POSIX interface)

IMPORTANT: Darwin syscall numbers are more stable than Windows but can still
vary between macOS versions. These numbers are for macOS 10.13+ (High Sierra and later).
:End Note

Note: ============================================================================
Note: BSD SYSCALL NUMBER CONSTANTS
Note: ============================================================================
Note: These are BSD-style syscall numbers for macOS ARM64
Note: Source: XNU kernel syscalls.master file

Process called "SYS_EXIT" returns Integer:
    Note: exit - terminate process
    Return 1
End Process

Process called "SYS_FORK" returns Integer:
    Note: fork - create child process
    Return 2
End Process

Process called "SYS_READ" returns Integer:
    Note: read - read from file descriptor
    Return 3
End Process

Process called "SYS_WRITE" returns Integer:
    Note: write - write to file descriptor
    Return 4
End Process

Process called "SYS_OPEN" returns Integer:
    Note: open - open file
    Return 5
End Process

Process called "SYS_CLOSE" returns Integer:
    Note: close - close file descriptor
    Return 6
End Process

Process called "SYS_MMAP" returns Integer:
    Note: mmap - map memory
    Return 197
End Process

Process called "SYS_MUNMAP" returns Integer:
    Note: munmap - unmap memory
    Return 73
End Process

Process called "SYS_MPROTECT" returns Integer:
    Note: mprotect - change memory protection
    Return 74
End Process

Process called "SYS_BRK" returns Integer:
    Note: brk is not available on Darwin, use mmap instead
    Note: Returning -1 to indicate unsupported
    Return -1
End Process

Process called "SYS_GETPID" returns Integer:
    Note: getpid - get process ID
    Return 20
End Process

Process called "SYS_KILL" returns Integer:
    Note: kill - send signal to process
    Return 37
End Process

Process called "SYS_DUP" returns Integer:
    Note: dup - duplicate file descriptor
    Return 41
End Process

Process called "SYS_DUP2" returns Integer:
    Note: dup2 - duplicate file descriptor to specific fd
    Return 90
End Process

Process called "SYS_PIPE" returns Integer:
    Note: pipe - create pipe
    Return 42
End Process

Process called "SYS_IOCTL" returns Integer:
    Note: ioctl - I/O control
    Return 54
End Process

Process called "SYS_FCNTL" returns Integer:
    Note: fcntl - file control
    Return 92
End Process

Process called "SYS_LSEEK" returns Integer:
    Note: lseek - reposition file offset
    Return 199
End Process

Process called "SYS_STAT" returns Integer:
    Note: stat - get file status
    Return 188
End Process

Process called "SYS_FSTAT" returns Integer:
    Note: fstat - get file status by fd
    Return 189
End Process

Process called "SYS_WAIT4" returns Integer:
    Note: wait4 - wait for process termination
    Return 7
End Process

Process called "SYS_LINK" returns Integer:
    Note: link - create hard link
    Return 9
End Process

Process called "SYS_UNLINK" returns Integer:
    Note: unlink - delete file
    Return 10
End Process

Process called "SYS_CHDIR" returns Integer:
    Note: chdir - change working directory
    Return 12
End Process

Process called "SYS_FCHDIR" returns Integer:
    Note: fchdir - change working directory by fd
    Return 13
End Process

Process called "SYS_MKNOD" returns Integer:
    Note: mknod - create special file
    Return 14
End Process

Process called "SYS_CHMOD" returns Integer:
    Note: chmod - change file mode
    Return 15
End Process

Process called "SYS_CHOWN" returns Integer:
    Note: chown - change file owner
    Return 16
End Process

Process called "SYS_GETFSSTAT" returns Integer:
    Note: getfsstat - get filesystem statistics
    Return 18
End Process

Process called "SYS_GETPPID" returns Integer:
    Note: getppid - get parent process ID
    Return 39
End Process

Process called "SYS_SIGACTION" returns Integer:
    Note: sigaction - examine/change signal action
    Return 46
End Process

Process called "SYS_SIGPROCMASK" returns Integer:
    Note: sigprocmask - examine/change blocked signals
    Return 48
End Process

Process called "SYS_ACCESS" returns Integer:
    Note: access - check file accessibility
    Return 33
End Process

Process called "SYS_CHFLAGS" returns Integer:
    Note: chflags - change file flags
    Return 34
End Process

Process called "SYS_FCHFLAGS" returns Integer:
    Note: fchflags - change file flags by fd
    Return 35
End Process

Process called "SYS_SYNC" returns Integer:
    Note: sync - synchronize disk buffers
    Return 36
End Process

Process called "SYS_SIGPENDING" returns Integer:
    Note: sigpending - get pending signals
    Return 52
End Process

Process called "SYS_SYMLINK" returns Integer:
    Note: symlink - create symbolic link
    Return 57
End Process

Process called "SYS_READLINK" returns Integer:
    Note: readlink - read symbolic link
    Return 58
End Process

Process called "SYS_EXECVE" returns Integer:
    Note: execve - execute program
    Return 59
End Process

Process called "SYS_UMASK" returns Integer:
    Note: umask - set file creation mask
    Return 60
End Process

Process called "SYS_CHROOT" returns Integer:
    Note: chroot - change root directory
    Return 61
End Process

Process called "SYS_MSYNC" returns Integer:
    Note: msync - synchronize memory with physical storage
    Return 65
End Process

Process called "SYS_VFORK" returns Integer:
    Note: vfork - create child process (deprecated, use fork)
    Return 66
End Process

Process called "SYS_SBRK" returns Integer:
    Note: sbrk is not available on Darwin, use mmap
    Return -1
End Process

Process called "SYS_SSTK" returns Integer:
    Note: sstk is not available on Darwin
    Return -1
End Process

Process called "SYS_MINCORE" returns Integer:
    Note: mincore - determine residency of memory pages
    Return 78
End Process

Process called "SYS_GETGROUPS" returns Integer:
    Note: getgroups - get group access list
    Return 79
End Process

Process called "SYS_SETGROUPS" returns Integer:
    Note: setgroups - set group access list
    Return 80
End Process

Process called "SYS_GETPGRP" returns Integer:
    Note: getpgrp - get process group
    Return 81
End Process

Process called "SYS_SETPGID" returns Integer:
    Note: setpgid - set process group ID
    Return 82
End Process

Process called "SYS_SETITIMER" returns Integer:
    Note: setitimer - set interval timer
    Return 83
End Process

Process called "SYS_SWAPON" returns Integer:
    Note: swapon - add swap device
    Return 85
End Process

Process called "SYS_GETITIMER" returns Integer:
    Note: getitimer - get interval timer
    Return 86
End Process

Process called "SYS_GETDTABLESIZE" returns Integer:
    Note: getdtablesize - get descriptor table size
    Return 89
End Process

Process called "SYS_READV" returns Integer:
    Note: readv - read into multiple buffers
    Return 120
End Process

Process called "SYS_WRITEV" returns Integer:
    Note: writev - write from multiple buffers
    Return 121
End Process

Process called "SYS_FCHOWN" returns Integer:
    Note: fchown - change file owner by fd
    Return 123
End Process

Process called "SYS_FCHMOD" returns Integer:
    Note: fchmod - change file mode by fd
    Return 124
End Process

Process called "SYS_SETREUID" returns Integer:
    Note: setreuid - set real and effective user ID
    Return 126
End Process

Process called "SYS_SETREGID" returns Integer:
    Note: setregid - set real and effective group ID
    Return 127
End Process

Process called "SYS_RENAME" returns Integer:
    Note: rename - rename file
    Return 128
End Process

Process called "SYS_FLOCK" returns Integer:
    Note: flock - apply advisory lock on file
    Return 131
End Process

Process called "SYS_MKFIFO" returns Integer:
    Note: mkfifo - create FIFO special file
    Return 132
End Process

Process called "SYS_SENDTO" returns Integer:
    Note: sendto - send message to socket
    Return 133
End Process

Process called "SYS_SHUTDOWN" returns Integer:
    Note: shutdown - shut down socket
    Return 134
End Process

Process called "SYS_SOCKETPAIR" returns Integer:
    Note: socketpair - create pair of connected sockets
    Return 135
End Process

Process called "SYS_MKDIR" returns Integer:
    Note: mkdir - create directory
    Return 136
End Process

Process called "SYS_RMDIR" returns Integer:
    Note: rmdir - remove directory
    Return 137
End Process

Process called "SYS_UTIMES" returns Integer:
    Note: utimes - set file access and modification times
    Return 138
End Process

Process called "SYS_FUTIMES" returns Integer:
    Note: futimes - set file times by fd
    Return 139
End Process

Process called "SYS_ADJTIME" returns Integer:
    Note: adjtime - correct time gradually
    Return 140
End Process

Process called "SYS_GETHOSTUUID" returns Integer:
    Note: gethostuuid - get host UUID
    Return 142
End Process

Process called "SYS_SETSID" returns Integer:
    Note: setsid - create session and set process group ID
    Return 147
End Process

Process called "SYS_GETPGID" returns Integer:
    Note: getpgid - get process group ID for session leader
    Return 151
End Process

Process called "SYS_SETPRIVEXEC" returns Integer:
    Note: setprivexec - set privilege exec flag
    Return 152
End Process

Process called "SYS_PREAD" returns Integer:
    Note: pread - read from file at offset
    Return 153
End Process

Process called "SYS_PWRITE" returns Integer:
    Note: pwrite - write to file at offset
    Return 154
End Process

Process called "SYS_NFSSVC" returns Integer:
    Note: nfssvc - NFS services
    Return 155
End Process

Process called "SYS_STATFS" returns Integer:
    Note: statfs - get filesystem statistics
    Return 157
End Process

Process called "SYS_FSTATFS" returns Integer:
    Note: fstatfs - get filesystem statistics by fd
    Return 158
End Process

Process called "SYS_UNMOUNT" returns Integer:
    Note: unmount - unmount filesystem
    Return 159
End Process

Process called "SYS_GETFH" returns Integer:
    Note: getfh - get file handle
    Return 161
End Process

Process called "SYS_QUOTACTL" returns Integer:
    Note: quotactl - manipulate filesystem quotas
    Return 165
End Process

Process called "SYS_MOUNT" returns Integer:
    Note: mount - mount filesystem
    Return 167
End Process

Process called "SYS_CSOPS" returns Integer:
    Note: csops - code signing operations
    Return 169
End Process

Process called "SYS_CSOPS_AUDITTOKEN" returns Integer:
    Note: csops_audittoken - code signing ops with audit token
    Return 170
End Process

Process called "SYS_WAITID" returns Integer:
    Note: waitid - wait for process state change
    Return 173
End Process

Process called "SYS_KDEBUG_TYPEFILTER" returns Integer:
    Note: kdebug_typefilter - kernel debug type filter
    Return 177
End Process

Process called "SYS_KDEBUG_TRACE_STRING" returns Integer:
    Note: kdebug_trace_string - kernel debug trace string
    Return 178
End Process

Process called "SYS_KDEBUG_TRACE64" returns Integer:
    Note: kdebug_trace64 - kernel debug trace 64-bit
    Return 179
End Process

Process called "SYS_KDEBUG_TRACE" returns Integer:
    Note: kdebug_trace - kernel debug trace
    Return 180
End Process

Process called "SYS_SETGID" returns Integer:
    Note: setgid - set group ID
    Return 181
End Process

Process called "SYS_SETEGID" returns Integer:
    Note: setegid - set effective group ID
    Return 182
End Process

Process called "SYS_SETEUID" returns Integer:
    Note: seteuid - set effective user ID
    Return 183
End Process

Process called "SYS_SIGRETURN" returns Integer:
    Note: sigreturn - return from signal handler
    Return 184
End Process

Process called "SYS_THREAD_SELFCOUNTS" returns Integer:
    Note: thread_selfcounts - get thread counts
    Return 186
End Process

Process called "SYS_FDATASYNC" returns Integer:
    Note: fdatasync - synchronize file data
    Return 187
End Process

Process called "SYS_LSTAT" returns Integer:
    Note: lstat - get file status (don't follow symlinks)
    Return 190
End Process

Process called "SYS_PATHCONF" returns Integer:
    Note: pathconf - get configurable pathname variables
    Return 191
End Process

Process called "SYS_FPATHCONF" returns Integer:
    Note: fpathconf - get configurable pathname variables by fd
    Return 192
End Process

Process called "SYS_GETRLIMIT" returns Integer:
    Note: getrlimit - get resource limits
    Return 194
End Process

Process called "SYS_SETRLIMIT" returns Integer:
    Note: setrlimit - set resource limits
    Return 195
End Process

Process called "SYS_GETDIRENTRIES" returns Integer:
    Note: getdirentries - get directory entries
    Return 196
End Process

Process called "SYS_LCHOWN" returns Integer:
    Note: lchown - change file owner (don't follow symlinks)
    Return 364
End Process

Process called "SYS_GETSID" returns Integer:
    Note: getsid - get session ID
    Return 310
End Process

Process called "SYS_SETTID_WITH_PID" returns Integer:
    Note: settid_with_pid - set thread ID with process ID
    Return 311
End Process

Process called "SYS_PREADV" returns Integer:
    Note: preadv - read into multiple buffers at offset
    Return 320
End Process

Process called "SYS_PWRITEV" returns Integer:
    Note: pwritev - write from multiple buffers at offset
    Return 321
End Process

Process called "SYS_AIO_FSYNC" returns Integer:
    Note: aio_fsync - asynchronous fsync
    Return 223
End Process

Process called "SYS_AIO_RETURN" returns Integer:
    Note: aio_return - retrieve return status of async I/O
    Return 224
End Process

Process called "SYS_AIO_SUSPEND" returns Integer:
    Note: aio_suspend - suspend until async I/O completes
    Return 225
End Process

Process called "SYS_AIO_CANCEL" returns Integer:
    Note: aio_cancel - cancel async I/O
    Return 226
End Process

Process called "SYS_AIO_ERROR" returns Integer:
    Note: aio_error - retrieve error status of async I/O
    Return 227
End Process

Process called "SYS_AIO_READ" returns Integer:
    Note: aio_read - asynchronous read
    Return 228
End Process

Process called "SYS_AIO_WRITE" returns Integer:
    Note: aio_write - asynchronous write
    Return 229
End Process

Process called "SYS_LIO_LISTIO" returns Integer:
    Note: lio_listio - list directed I/O
    Return 230
End Process

Process called "SYS_IOPOLICYSYS" returns Integer:
    Note: iopolicysys - I/O policy system call
    Return 322
End Process

Process called "SYS_PROCESS_POLICY" returns Integer:
    Note: process_policy - process policy control
    Return 323
End Process

Process called "SYS_MLOCKALL" returns Integer:
    Note: mlockall - lock all pages in memory
    Return 324
End Process

Process called "SYS_MUNLOCKALL" returns Integer:
    Note: munlockall - unlock all pages in memory
    Return 325
End Process

Process called "SYS_ISSETUGID" returns Integer:
    Note: issetugid - check if process is tainted
    Return 327
End Process

Process called "SYS___PTHREAD_KILL" returns Integer:
    Note: __pthread_kill - send signal to thread
    Return 328
End Process

Process called "SYS___PTHREAD_SIGMASK" returns Integer:
    Note: __pthread_sigmask - examine/change thread signal mask
    Return 329
End Process

Process called "SYS___SIGWAIT" returns Integer:
    Note: __sigwait - wait for signal
    Return 330
End Process

Process called "SYS___DISABLE_THREADSIGNAL" returns Integer:
    Note: __disable_threadsignal - disable thread signal
    Return 331
End Process

Process called "SYS___PTHREAD_MARKCANCEL" returns Integer:
    Note: __pthread_markcancel - mark thread for cancellation
    Return 332
End Process

Process called "SYS___PTHREAD_CANCELED" returns Integer:
    Note: __pthread_canceled - check if thread canceled
    Return 333
End Process

Process called "SYS___SEMWAIT_SIGNAL" returns Integer:
    Note: __semwait_signal - wait on semaphore with signal
    Return 334
End Process

Process called "SYS_PROC_INFO" returns Integer:
    Note: proc_info - get process information
    Return 336
End Process

Process called "SYS_SENDFILE" returns Integer:
    Note: sendfile - send file to socket
    Return 337
End Process

Process called "SYS_STAT64" returns Integer:
    Note: stat64 - get 64-bit file status
    Return 338
End Process

Process called "SYS_FSTAT64" returns Integer:
    Note: fstat64 - get 64-bit file status by fd
    Return 339
End Process

Process called "SYS_LSTAT64" returns Integer:
    Note: lstat64 - get 64-bit file status (no follow)
    Return 340
End Process

Process called "SYS_STAT64_EXTENDED" returns Integer:
    Note: stat64_extended - extended 64-bit stat
    Return 341
End Process

Process called "SYS_LSTAT64_EXTENDED" returns Integer:
    Note: lstat64_extended - extended 64-bit lstat
    Return 342
End Process

Process called "SYS_FSTAT64_EXTENDED" returns Integer:
    Note: fstat64_extended - extended 64-bit fstat
    Return 343
End Process

Process called "SYS_GETDIRENTRIES64" returns Integer:
    Note: getdirentries64 - get 64-bit directory entries
    Return 344
End Process

Process called "SYS_STATFS64" returns Integer:
    Note: statfs64 - get 64-bit filesystem statistics
    Return 345
End Process

Process called "SYS_FSTATFS64" returns Integer:
    Note: fstatfs64 - get 64-bit filesystem statistics by fd
    Return 346
End Process

Process called "SYS_GETFSSTAT64" returns Integer:
    Note: getfsstat64 - get 64-bit filesystem statistics
    Return 347
End Process

Process called "SYS___PTHREAD_CHDIR" returns Integer:
    Note: __pthread_chdir - thread-specific chdir
    Return 348
End Process

Process called "SYS___PTHREAD_FCHDIR" returns Integer:
    Note: __pthread_fchdir - thread-specific fchdir
    Return 349
End Process

Process called "SYS_AUDIT" returns Integer:
    Note: audit - submit audit record
    Return 350
End Process

Process called "SYS_AUDITON" returns Integer:
    Note: auditon - configure system audit parameters
    Return 351
End Process

Process called "SYS_GETAUID" returns Integer:
    Note: getauid - get audit user ID
    Return 353
End Process

Process called "SYS_SETAUID" returns Integer:
    Note: setauid - set audit user ID
    Return 354
End Process

Process called "SYS_GETAUDIT_ADDR" returns Integer:
    Note: getaudit_addr - get audit session state
    Return 357
End Process

Process called "SYS_SETAUDIT_ADDR" returns Integer:
    Note: setaudit_addr - set audit session state
    Return 358
End Process

Process called "SYS_AUDITCTL" returns Integer:
    Note: auditctl - control audit subsystem
    Return 359
End Process

Process called "SYS_BSDTHREAD_CREATE" returns Integer:
    Note: bsdthread_create - create BSD thread
    Return 360
End Process

Process called "SYS_BSDTHREAD_TERMINATE" returns Integer:
    Note: bsdthread_terminate - terminate BSD thread
    Return 361
End Process

Process called "SYS_KQUEUE" returns Integer:
    Note: kqueue - create kernel event queue
    Return 362
End Process

Process called "SYS_KEVENT" returns Integer:
    Note: kevent - kernel event notification
    Return 363
End Process

Process called "SYS_KEVENT64" returns Integer:
    Note: kevent64 - 64-bit kernel event notification
    Return 369
End Process

Process called "SYS___OLD_SEMWAIT_SIGNAL" returns Integer:
    Note: __old_semwait_signal - old semaphore wait (deprecated)
    Return 370
End Process

Process called "SYS___OLD_SEMWAIT_SIGNAL_NOCANCEL" returns Integer:
    Note: __old_semwait_signal_nocancel - old semwait no cancel (deprecated)
    Return 371
End Process

Process called "SYS_THREAD_SELFID" returns Integer:
    Note: thread_selfid - get thread ID
    Return 372
End Process

Process called "SYS_LEDGER" returns Integer:
    Note: ledger - resource accounting
    Return 373
End Process

Process called "SYS_KEVENT_QOS" returns Integer:
    Note: kevent_qos - kernel event with QoS
    Return 374
End Process

Process called "SYS_KEVENT_ID" returns Integer:
    Note: kevent_id - kernel event with ID
    Return 375
End Process

Process called "SYS___MAC_EXECVE" returns Integer:
    Note: __mac_execve - execute with MAC policy
    Return 380
End Process

Process called "SYS___MAC_SYSCALL" returns Integer:
    Note: __mac_syscall - MAC policy syscall
    Return 381
End Process

Process called "SYS___MAC_GET_FILE" returns Integer:
    Note: __mac_get_file - get MAC label for file
    Return 382
End Process

Process called "SYS___MAC_SET_FILE" returns Integer:
    Note: __mac_set_file - set MAC label for file
    Return 383
End Process

Process called "SYS___MAC_GET_LINK" returns Integer:
    Note: __mac_get_link - get MAC label for link
    Return 384
End Process

Process called "SYS___MAC_SET_LINK" returns Integer:
    Note: __mac_set_link - set MAC label for link
    Return 385
End Process

Process called "SYS___MAC_GET_PROC" returns Integer:
    Note: __mac_get_proc - get MAC label for process
    Return 386
End Process

Process called "SYS___MAC_SET_PROC" returns Integer:
    Note: __mac_set_proc - set MAC label for process
    Return 387
End Process

Process called "SYS___MAC_GET_FD" returns Integer:
    Note: __mac_get_fd - get MAC label for fd
    Return 388
End Process

Process called "SYS___MAC_SET_FD" returns Integer:
    Note: __mac_set_fd - set MAC label for fd
    Return 389
End Process

Process called "SYS___MAC_GET_PID" returns Integer:
    Note: __mac_get_pid - get MAC label for PID
    Return 390
End Process

Process called "SYS_PSELECT" returns Integer:
    Note: pselect - synchronous I/O multiplexing
    Return 394
End Process

Process called "SYS_PSELECT_NOCANCEL" returns Integer:
    Note: pselect_nocancel - pselect without cancellation
    Return 395
End Process

Process called "SYS_READ_NOCANCEL" returns Integer:
    Note: read_nocancel - read without cancellation
    Return 396
End Process

Process called "SYS_WRITE_NOCANCEL" returns Integer:
    Note: write_nocancel - write without cancellation
    Return 397
End Process

Process called "SYS_OPEN_NOCANCEL" returns Integer:
    Note: open_nocancel - open without cancellation
    Return 398
End Process

Process called "SYS_CLOSE_NOCANCEL" returns Integer:
    Note: close_nocancel - close without cancellation
    Return 399
End Process

Process called "SYS_WAIT4_NOCANCEL" returns Integer:
    Note: wait4_nocancel - wait4 without cancellation
    Return 400
End Process

Process called "SYS_RECVMSG_NOCANCEL" returns Integer:
    Note: recvmsg_nocancel - receive message without cancellation
    Return 401
End Process

Process called "SYS_SENDMSG_NOCANCEL" returns Integer:
    Note: sendmsg_nocancel - send message without cancellation
    Return 402
End Process

Process called "SYS_RECVFROM_NOCANCEL" returns Integer:
    Note: recvfrom_nocancel - receive from without cancellation
    Return 403
End Process

Process called "SYS_ACCEPT_NOCANCEL" returns Integer:
    Note: accept_nocancel - accept without cancellation
    Return 404
End Process

Process called "SYS_MSYNC_NOCANCEL" returns Integer:
    Note: msync_nocancel - msync without cancellation
    Return 405
End Process

Process called "SYS_FCNTL_NOCANCEL" returns Integer:
    Note: fcntl_nocancel - fcntl without cancellation
    Return 406
End Process

Process called "SYS_SELECT_NOCANCEL" returns Integer:
    Note: select_nocancel - select without cancellation
    Return 407
End Process

Process called "SYS_FSYNC_NOCANCEL" returns Integer:
    Note: fsync_nocancel - fsync without cancellation
    Return 408
End Process

Process called "SYS_CONNECT_NOCANCEL" returns Integer:
    Note: connect_nocancel - connect without cancellation
    Return 409
End Process

Process called "SYS_SIGSUSPEND_NOCANCEL" returns Integer:
    Note: sigsuspend_nocancel - sigsuspend without cancellation
    Return 410
End Process

Process called "SYS_READV_NOCANCEL" returns Integer:
    Note: readv_nocancel - readv without cancellation
    Return 411
End Process

Process called "SYS_WRITEV_NOCANCEL" returns Integer:
    Note: writev_nocancel - writev without cancellation
    Return 412
End Process

Process called "SYS_SENDTO_NOCANCEL" returns Integer:
    Note: sendto_nocancel - sendto without cancellation
    Return 413
End Process

Process called "SYS_PREAD_NOCANCEL" returns Integer:
    Note: pread_nocancel - pread without cancellation
    Return 414
End Process

Process called "SYS_PWRITE_NOCANCEL" returns Integer:
    Note: pwrite_nocancel - pwrite without cancellation
    Return 415
End Process

Process called "SYS_WAITID_NOCANCEL" returns Integer:
    Note: waitid_nocancel - waitid without cancellation
    Return 416
End Process

Process called "SYS_POLL_NOCANCEL" returns Integer:
    Note: poll_nocancel - poll without cancellation
    Return 417
End Process

Process called "SYS_MSGSND_NOCANCEL" returns Integer:
    Note: msgsnd_nocancel - message send without cancellation
    Return 418
End Process

Process called "SYS_MSGRCV_NOCANCEL" returns Integer:
    Note: msgrcv_nocancel - message receive without cancellation
    Return 419
End Process

Process called "SYS_SEM_WAIT_NOCANCEL" returns Integer:
    Note: sem_wait_nocancel - semaphore wait without cancellation
    Return 420
End Process

Process called "SYS_AIO_SUSPEND_NOCANCEL" returns Integer:
    Note: aio_suspend_nocancel - aio suspend without cancellation
    Return 421
End Process

Process called "SYS___SIGWAIT_NOCANCEL" returns Integer:
    Note: __sigwait_nocancel - sigwait without cancellation
    Return 422
End Process

Process called "SYS___SEMWAIT_SIGNAL_NOCANCEL" returns Integer:
    Note: __semwait_signal_nocancel - semwait signal without cancellation
    Return 423
End Process

Process called "SYS___MAC_MOUNT" returns Integer:
    Note: __mac_mount - mount with MAC label
    Return 424
End Process

Process called "SYS___MAC_GET_MOUNT" returns Integer:
    Note: __mac_get_mount - get MAC label for mount
    Return 425
End Process

Process called "SYS___MAC_GETFSSTAT" returns Integer:
    Note: __mac_getfsstat - get filesystem stats with MAC
    Return 426
End Process

Process called "SYS_FSGETPATH" returns Integer:
    Note: fsgetpath - get path for filesystem ID
    Return 427
End Process

Process called "SYS_AUDIT_SESSION_SELF" returns Integer:
    Note: audit_session_self - get audit session ID
    Return 428
End Process

Process called "SYS_AUDIT_SESSION_JOIN" returns Integer:
    Note: audit_session_join - join audit session
    Return 429
End Process

Process called "SYS_FILEPORT_MAKEPORT" returns Integer:
    Note: fileport_makeport - create Mach port for file
    Return 430
End Process

Process called "SYS_FILEPORT_MAKEFD" returns Integer:
    Note: fileport_makefd - create fd from Mach port
    Return 431
End Process

Process called "SYS_AUDIT_SESSION_PORT" returns Integer:
    Note: audit_session_port - get audit session port
    Return 432
End Process

Process called "SYS_PID_SUSPEND" returns Integer:
    Note: pid_suspend - suspend process
    Return 433
End Process

Process called "SYS_PID_RESUME" returns Integer:
    Note: pid_resume - resume process
    Return 434
End Process

Process called "SYS_PID_HIBERNATE" returns Integer:
    Note: pid_hibernate - hibernate process
    Return 435
End Process

Process called "SYS_PID_SHUTDOWN_SOCKETS" returns Integer:
    Note: pid_shutdown_sockets - shutdown process sockets
    Return 436
End Process

Process called "SYS_SHARED_REGION_MAP_AND_SLIDE_NP" returns Integer:
    Note: shared_region_map_and_slide_np - map shared region with slide
    Return 438
End Process

Process called "SYS_KAS_INFO" returns Integer:
    Note: kas_info - kernel address space information
    Return 439
End Process

Process called "SYS_MEMORYSTATUS_CONTROL" returns Integer:
    Note: memorystatus_control - memory status control
    Return 440
End Process

Process called "SYS_GUARDED_OPEN_NP" returns Integer:
    Note: guarded_open_np - open file with guard
    Return 441
End Process

Process called "SYS_GUARDED_CLOSE_NP" returns Integer:
    Note: guarded_close_np - close guarded file
    Return 442
End Process

Process called "SYS_GUARDED_KQUEUE_NP" returns Integer:
    Note: guarded_kqueue_np - create guarded kqueue
    Return 443
End Process

Process called "SYS_CHANGE_FDGUARD_NP" returns Integer:
    Note: change_fdguard_np - change file descriptor guard
    Return 444
End Process

Process called "SYS_USRCTL" returns Integer:
    Note: usrctl - user control
    Return 445
End Process

Process called "SYS_PROC_RLIMIT_CONTROL" returns Integer:
    Note: proc_rlimit_control - process resource limit control
    Return 446
End Process

Process called "SYS_CONNECTX" returns Integer:
    Note: connectx - extended connect
    Return 447
End Process

Process called "SYS_DISCONNECTX" returns Integer:
    Note: disconnectx - extended disconnect
    Return 448
End Process

Process called "SYS_PEELOFF" returns Integer:
    Note: peeloff - peel off association
    Return 449
End Process

Process called "SYS_SOCKET_DELEGATE" returns Integer:
    Note: socket_delegate - socket delegation
    Return 450
End Process

Process called "SYS_TELEMETRY" returns Integer:
    Note: telemetry - system telemetry
    Return 451
End Process

Process called "SYS_PROC_UUID_POLICY" returns Integer:
    Note: proc_uuid_policy - process UUID policy
    Return 452
End Process

Process called "SYS_MEMORYSTATUS_GET_LEVEL" returns Integer:
    Note: memorystatus_get_level - get memory status level
    Return 453
End Process

Process called "SYS_SYSTEM_OVERRIDE" returns Integer:
    Note: system_override - system behavior override
    Return 454
End Process

Process called "SYS_VFS_PURGE" returns Integer:
    Note: vfs_purge - purge VFS cache
    Return 455
End Process

Process called "SYS_SFI_CTL" returns Integer:
    Note: sfi_ctl - Selective Forced Idle control
    Return 456
End Process

Process called "SYS_SFI_PIDCTL" returns Integer:
    Note: sfi_pidctl - SFI per-process control
    Return 457
End Process

Process called "SYS_COALITION" returns Integer:
    Note: coalition - coalition operations
    Return 458
End Process

Process called "SYS_COALITION_INFO" returns Integer:
    Note: coalition_info - get coalition information
    Return 459
End Process

Process called "SYS_NECP_MATCH_POLICY" returns Integer:
    Note: necp_match_policy - Network Extension Control Policy match
    Return 460
End Process

Process called "SYS_GETATTRLISTBULK" returns Integer:
    Note: getattrlistbulk - get attribute list in bulk
    Return 461
End Process

Process called "SYS_CLONEFILEAT" returns Integer:
    Note: clonefileat - clone file at path
    Return 462
End Process

Process called "SYS_OPENAT" returns Integer:
    Note: openat - open file relative to directory fd
    Return 463
End Process

Process called "SYS_OPENAT_NOCANCEL" returns Integer:
    Note: openat_nocancel - openat without cancellation
    Return 464
End Process

Process called "SYS_RENAMEAT" returns Integer:
    Note: renameat - rename file relative to directory fd
    Return 465
End Process

Process called "SYS_FACCESSAT" returns Integer:
    Note: faccessat - check accessibility relative to directory fd
    Return 466
End Process

Process called "SYS_FCHMODAT" returns Integer:
    Note: fchmodat - change mode relative to directory fd
    Return 467
End Process

Process called "SYS_FCHOWNAT" returns Integer:
    Note: fchownat - change owner relative to directory fd
    Return 468
End Process

Process called "SYS_FSTATAT" returns Integer:
    Note: fstatat - get file status relative to directory fd
    Return 469
End Process

Process called "SYS_FSTATAT64" returns Integer:
    Note: fstatat64 - get 64-bit file status relative to directory fd
    Return 470
End Process

Process called "SYS_LINKAT" returns Integer:
    Note: linkat - create link relative to directory fd
    Return 471
End Process

Process called "SYS_UNLINKAT" returns Integer:
    Note: unlinkat - remove file relative to directory fd
    Return 472
End Process

Process called "SYS_READLINKAT" returns Integer:
    Note: readlinkat - read symbolic link relative to directory fd
    Return 473
End Process

Process called "SYS_SYMLINKAT" returns Integer:
    Note: symlinkat - create symbolic link relative to directory fd
    Return 474
End Process

Process called "SYS_MKDIRAT" returns Integer:
    Note: mkdirat - create directory relative to directory fd
    Return 475
End Process

Process called "SYS_GETATTRLISTAT" returns Integer:
    Note: getattrlistat - get attribute list relative to directory fd
    Return 476
End Process

Process called "SYS_PROC_TRACE_LOG" returns Integer:
    Note: proc_trace_log - process trace logging
    Return 477
End Process

Process called "SYS_BSDTHREAD_CTL" returns Integer:
    Note: bsdthread_ctl - BSD thread control
    Return 478
End Process

Process called "SYS_OPENBYID_NP" returns Integer:
    Note: openbyid_np - open file by ID
    Return 479
End Process

Process called "SYS_RECVMSG_X" returns Integer:
    Note: recvmsg_x - extended receive message
    Return 480
End Process

Process called "SYS_SENDMSG_X" returns Integer:
    Note: sendmsg_x - extended send message
    Return 481
End Process

Process called "SYS_THREAD_SELFUSAGE" returns Integer:
    Note: thread_selfusage - get thread usage
    Return 482
End Process

Process called "SYS_CSRCTL" returns Integer:
    Note: csrctl - System Integrity Protection control
    Return 483
End Process

Process called "SYS_GUARDED_OPEN_DPROTECTED_NP" returns Integer:
    Note: guarded_open_dprotected_np - open data protected file with guard
    Return 484
End Process

Process called "SYS_GUARDED_WRITE_NP" returns Integer:
    Note: guarded_write_np - guarded write
    Return 485
End Process

Process called "SYS_GUARDED_PWRITE_NP" returns Integer:
    Note: guarded_pwrite_np - guarded pwrite
    Return 486
End Process

Process called "SYS_GUARDED_WRITEV_NP" returns Integer:
    Note: guarded_writev_np - guarded writev
    Return 487
End Process

Process called "SYS_RENAMEATX_NP" returns Integer:
    Note: renameatx_np - extended renameat
    Return 488
End Process

Process called "SYS_MREMAP_ENCRYPTED" returns Integer:
    Note: mremap_encrypted - remap encrypted memory
    Return 489
End Process

Process called "SYS_NETAGENT_TRIGGER" returns Integer:
    Note: netagent_trigger - network agent trigger
    Return 490
End Process

Process called "SYS_STACK_SNAPSHOT_WITH_CONFIG" returns Integer:
    Note: stack_snapshot_with_config - stack snapshot with configuration
    Return 491
End Process

Process called "SYS_MICROSTACKSHOT" returns Integer:
    Note: microstackshot - micro stack snapshot
    Return 492
End Process

Process called "SYS_GRAB_PGO_DATA" returns Integer:
    Note: grab_pgo_data - grab profile-guided optimization data
    Return 493
End Process

Process called "SYS_PERSONA" returns Integer:
    Note: persona - persona management
    Return 494
End Process

Process called "SYS_WORK_INTERVAL_CTL" returns Integer:
    Note: work_interval_ctl - work interval control
    Return 499
End Process

Process called "SYS_GETENTROPY" returns Integer:
    Note: getentropy - get random entropy
    Return 500
End Process

Process called "SYS_NECP_OPEN" returns Integer:
    Note: necp_open - open NECP session
    Return 501
End Process

Process called "SYS_NECP_CLIENT_ACTION" returns Integer:
    Note: necp_client_action - NECP client action
    Return 502
End Process

Process called "SYS___NEXUS_OPEN" returns Integer:
    Note: __nexus_open - open network nexus
    Return 503
End Process

Process called "SYS___NEXUS_REGISTER" returns Integer:
    Note: __nexus_register - register network nexus
    Return 504
End Process

Process called "SYS___NEXUS_DEREGISTER" returns Integer:
    Note: __nexus_deregister - deregister network nexus
    Return 505
End Process

Process called "SYS___NEXUS_CREATE" returns Integer:
    Note: __nexus_create - create network nexus
    Return 506
End Process

Process called "SYS___NEXUS_DESTROY" returns Integer:
    Note: __nexus_destroy - destroy network nexus
    Return 507
End Process

Process called "SYS___NEXUS_GET_OPT" returns Integer:
    Note: __nexus_get_opt - get nexus option
    Return 508
End Process

Process called "SYS___NEXUS_SET_OPT" returns Integer:
    Note: __nexus_set_opt - set nexus option
    Return 509
End Process

Process called "SYS___CHANNEL_OPEN" returns Integer:
    Note: __channel_open - open network channel
    Return 510
End Process

Process called "SYS___CHANNEL_GET_INFO" returns Integer:
    Note: __channel_get_info - get channel information
    Return 511
End Process

Process called "SYS___CHANNEL_SYNC" returns Integer:
    Note: __channel_sync - synchronize network channel
    Return 512
End Process

Process called "SYS___CHANNEL_GET_OPT" returns Integer:
    Note: __channel_get_opt - get channel option
    Return 513
End Process

Process called "SYS___CHANNEL_SET_OPT" returns Integer:
    Note: __channel_set_opt - set channel option
    Return 514
End Process

Process called "SYS_ULOCK_WAIT" returns Integer:
    Note: ulock_wait - user-space lock wait
    Return 515
End Process

Process called "SYS_ULOCK_WAKE" returns Integer:
    Note: ulock_wake - user-space lock wake
    Return 516
End Process

Process called "SYS_FCLONEFILEAT" returns Integer:
    Note: fclonefileat - clone file at fd
    Return 517
End Process

Process called "SYS_FS_SNAPSHOT" returns Integer:
    Note: fs_snapshot - filesystem snapshot operations
    Return 518
End Process

Process called "SYS_TERMINATE_WITH_PAYLOAD" returns Integer:
    Note: terminate_with_payload - terminate with payload
    Return 520
End Process

Process called "SYS_ABORT_WITH_PAYLOAD" returns Integer:
    Note: abort_with_payload - abort with payload
    Return 521
End Process

Process called "SYS_NECP_SESSION_OPEN" returns Integer:
    Note: necp_session_open - open NECP session
    Return 522
End Process

Process called "SYS_NECP_SESSION_ACTION" returns Integer:
    Note: necp_session_action - NECP session action
    Return 523
End Process

Process called "SYS_SETATTRLISTAT" returns Integer:
    Note: setattrlistat - set attribute list at path
    Return 524
End Process

Process called "SYS_NET_QOS_GUIDELINE" returns Integer:
    Note: net_qos_guideline - network QoS guideline
    Return 525
End Process

Process called "SYS_FMOUNT" returns Integer:
    Note: fmount - mount by file descriptor
    Return 526
End Process

Process called "SYS_NTP_ADJTIME" returns Integer:
    Note: ntp_adjtime - adjust NTP time
    Return 527
End Process

Process called "SYS_NTP_GETTIME" returns Integer:
    Note: ntp_gettime - get NTP time
    Return 528
End Process

Process called "SYS_OS_FAULT_WITH_PAYLOAD" returns Integer:
    Note: os_fault_with_payload - OS fault with payload
    Return 529
End Process

Process called "SYS_KQUEUE_WORKLOOP_CTL" returns Integer:
    Note: kqueue_workloop_ctl - kqueue workloop control
    Return 530
End Process

Process called "SYS___MACH_BRIDGE_REMOTE_TIME" returns Integer:
    Note: __mach_bridge_remote_time - Mach bridge remote time
    Return 531
End Process

Process called "SYS_COALITION_LEDGER" returns Integer:
    Note: coalition_ledger - coalition ledger operations
    Return 532
End Process

Process called "SYS_LOG_DATA" returns Integer:
    Note: log_data - log data to system
    Return 533
End Process

Process called "SYS_MEMORYSTATUS_AVAILABLE_MEMORY" returns Integer:
    Note: memorystatus_available_memory - get available memory
    Return 534
End Process

Process called "SYS_OBJC_BP_ASSIST_CFG_NP" returns Integer:
    Note: objc_bp_assist_cfg_np - Objective-C breakpoint assist config
    Return 535
End Process

Process called "SYS_SHARED_REGION_MAP_AND_SLIDE_2_NP" returns Integer:
    Note: shared_region_map_and_slide_2_np - map shared region v2
    Return 536
End Process

Process called "SYS_PIVOT_ROOT" returns Integer:
    Note: pivot_root - change root filesystem
    Return 537
End Process

Process called "SYS_TASK_INSPECT_FOR_PID" returns Integer:
    Note: task_inspect_for_pid - inspect task for PID
    Return 538
End Process

Process called "SYS_TASK_READ_FOR_PID" returns Integer:
    Note: task_read_for_pid - read task for PID
    Return 539
End Process

Process called "SYS_PREADV_NOCANCEL" returns Integer:
    Note: preadv_nocancel - preadv without cancellation
    Return 540
End Process

Process called "SYS_PWRITEV_NOCANCEL" returns Integer:
    Note: pwritev_nocancel - pwritev without cancellation
    Return 541
End Process

Process called "SYS_ULOCK_WAIT2" returns Integer:
    Note: ulock_wait2 - user-space lock wait v2
    Return 542
End Process

Process called "SYS_PROC_INFO_EXTENDED_ID" returns Integer:
    Note: proc_info_extended_id - get extended process info
    Return 543
End Process

Note: ============================================================================
Note: NETWORK SOCKET SYSCALLS
Note: ============================================================================

Process called "SYS_SOCKET" returns Integer:
    Note: socket - create socket
    Return 97
End Process

Process called "SYS_CONNECT" returns Integer:
    Note: connect - initiate connection on socket
    Return 98
End Process

Process called "SYS_ACCEPT" returns Integer:
    Note: accept - accept connection on socket
    Return 30
End Process

Process called "SYS_GETPEERNAME" returns Integer:
    Note: getpeername - get name of connected peer
    Return 31
End Process

Process called "SYS_GETSOCKNAME" returns Integer:
    Note: getsockname - get socket name
    Return 32
End Process

Process called "SYS_BIND" returns Integer:
    Note: bind - bind name to socket
    Return 104
End Process

Process called "SYS_SETSOCKOPT" returns Integer:
    Note: setsockopt - set socket options
    Return 105
End Process

Process called "SYS_LISTEN" returns Integer:
    Note: listen - listen for connections on socket
    Return 106
End Process

Process called "SYS_GETSOCKOPT" returns Integer:
    Note: getsockopt - get socket options
    Return 118
End Process

Process called "SYS_RECVMSG" returns Integer:
    Note: recvmsg - receive message from socket
    Return 27
End Process

Process called "SYS_SENDMSG" returns Integer:
    Note: sendmsg - send message on socket
    Return 28
End Process

Process called "SYS_RECVFROM" returns Integer:
    Note: recvfrom - receive message from socket
    Return 29
End Process

Note: ============================================================================
Note: SYSTEM V IPC SYSCALLS
Note: ============================================================================

Process called "SYS_SEMGET" returns Integer:
    Note: semget - get semaphore set
    Return 250
End Process

Process called "SYS_SEMOP" returns Integer:
    Note: semop - semaphore operations
    Return 251
End Process

Process called "SYS_MSGGET" returns Integer:
    Note: msgget - get message queue
    Return 252
End Process

Process called "SYS_MSGSND" returns Integer:
    Note: msgsnd - send message
    Return 253
End Process

Process called "SYS_MSGRCV" returns Integer:
    Note: msgrcv - receive message
    Return 254
End Process

Process called "SYS_SHMAT" returns Integer:
    Note: shmat - attach shared memory
    Return 255
End Process

Process called "SYS_SHMCTL" returns Integer:
    Note: shmctl - shared memory control
    Return 256
End Process

Process called "SYS_SHMDT" returns Integer:
    Note: shmdt - detach shared memory
    Return 257
End Process

Process called "SYS_SHMGET" returns Integer:
    Note: shmget - get shared memory
    Return 258
End Process

Process called "SYS_SHM_OPEN" returns Integer:
    Note: shm_open - open shared memory object
    Return 266
End Process

Process called "SYS_SHM_UNLINK" returns Integer:
    Note: shm_unlink - unlink shared memory object
    Return 267
End Process

Process called "SYS_SEM_OPEN" returns Integer:
    Note: sem_open - open named semaphore
    Return 268
End Process

Process called "SYS_SEM_CLOSE" returns Integer:
    Note: sem_close - close named semaphore
    Return 269
End Process

Process called "SYS_SEM_UNLINK" returns Integer:
    Note: sem_unlink - unlink named semaphore
    Return 270
End Process

Process called "SYS_SEM_WAIT" returns Integer:
    Note: sem_wait - wait on semaphore
    Return 271
End Process

Process called "SYS_SEM_TRYWAIT" returns Integer:
    Note: sem_trywait - try to wait on semaphore
    Return 272
End Process

Process called "SYS_SEM_POST" returns Integer:
    Note: sem_post - post to semaphore
    Return 273
End Process

Note: ============================================================================
Note: TIME AND CLOCK SYSCALLS
Note: ============================================================================

Process called "SYS_GETTIMEOFDAY" returns Integer:
    Note: gettimeofday - get time of day
    Return 116
End Process

Process called "SYS_SETTIMEOFDAY" returns Integer:
    Note: settimeofday - set time of day
    Return 122
End Process

Process called "SYS_CLOCK_GETTIME" returns Integer:
    Note: clock_gettime - get time of specified clock
    Return 236
End Process

Process called "SYS_CLOCK_SETTIME" returns Integer:
    Note: clock_settime - set time of specified clock
    Return 237
End Process

Process called "SYS_CLOCK_GETRES" returns Integer:
    Note: clock_getres - get clock resolution
    Return 238
End Process

Process called "SYS_NANOSLEEP" returns Integer:
    Note: nanosleep - high resolution sleep
    Return 240
End Process

Note: ============================================================================
Note: USER/GROUP ID SYSCALLS
Note: ============================================================================

Process called "SYS_GETUID" returns Integer:
    Note: getuid - get real user ID
    Return 24
End Process

Process called "SYS_GETEUID" returns Integer:
    Note: geteuid - get effective user ID
    Return 25
End Process

Process called "SYS_GETGID" returns Integer:
    Note: getgid - get real group ID
    Return 47
End Process

Process called "SYS_GETEGID" returns Integer:
    Note: getegid - get effective group ID
    Return 43
End Process

Process called "SYS_SETUID" returns Integer:
    Note: setuid - set user ID
    Return 23
End Process

Note: ============================================================================
Note: I/O MULTIPLEXING SYSCALLS
Note: ============================================================================

Process called "SYS_SELECT" returns Integer:
    Note: select - synchronous I/O multiplexing
    Return 93
End Process

Process called "SYS_POLL" returns Integer:
    Note: poll - synchronous I/O multiplexing
    Return 230
End Process

Note: ============================================================================
Note: MEMORY LOCKING SYSCALLS
Note: ============================================================================

Process called "SYS_MLOCK" returns Integer:
    Note: mlock - lock pages in memory
    Return 203
End Process

Process called "SYS_MUNLOCK" returns Integer:
    Note: munlock - unlock pages in memory
    Return 204
End Process

Process called "SYS_MADVISE" returns Integer:
    Note: madvise - give advice about use of memory
    Return 75
End Process

Note: ============================================================================
Note: FILE SYSTEM CONTROL SYSCALLS
Note: ============================================================================

Process called "SYS_FSYNC" returns Integer:
    Note: fsync - synchronize file data and metadata
    Return 95
End Process

Process called "SYS_FTRUNCATE" returns Integer:
    Note: ftruncate - truncate file to specified length
    Return 201
End Process

Process called "SYS_TRUNCATE" returns Integer:
    Note: truncate - truncate file to specified length
    Return 200
End Process

Process called "SYS_GETATTRLIST" returns Integer:
    Note: getattrlist - get file system attributes
    Return 220
End Process

Process called "SYS_SETATTRLIST" returns Integer:
    Note: setattrlist - set file system attributes
    Return 221
End Process

Process called "SYS_GETXATTR" returns Integer:
    Note: getxattr - get extended attribute value
    Return 234
End Process

Process called "SYS_FGETXATTR" returns Integer:
    Note: fgetxattr - get extended attribute value by fd
    Return 235
End Process

Process called "SYS_SETXATTR" returns Integer:
    Note: setxattr - set extended attribute value
    Return 236
End Process

Process called "SYS_FSETXATTR" returns Integer:
    Note: fsetxattr - set extended attribute value by fd
    Return 237
End Process

Process called "SYS_REMOVEXATTR" returns Integer:
    Note: removexattr - remove extended attribute
    Return 238
End Process

Process called "SYS_FREMOVEXATTR" returns Integer:
    Note: fremovexattr - remove extended attribute by fd
    Return 239
End Process

Process called "SYS_LISTXATTR" returns Integer:
    Note: listxattr - list extended attribute names
    Return 240
End Process

Process called "SYS_FLISTXATTR" returns Integer:
    Note: flistxattr - list extended attribute names by fd
    Return 241
End Process

Process called "SYS_EXCHANGEDATA" returns Integer:
    Note: exchangedata - atomically exchange data between two files
    Return 223
End Process

Process called "SYS_SEARCHFS" returns Integer:
    Note: searchfs - search filesystem
    Return 225
End Process

Process called "SYS_DELETE" returns Integer:
    Note: delete - delete file (Carbon delete, not unlink)
    Return 226
End Process

Process called "SYS_COPYFILE" returns Integer:
    Note: copyfile - copy file
    Return 227
End Process

Process called "SYS_FGETATTRLIST" returns Integer:
    Note: fgetattrlist - get file system attributes by fd
    Return 228
End Process

Process called "SYS_FSETATTRLIST" returns Integer:
    Note: fsetattrlist - set file system attributes by fd
    Return 229
End Process

Note: ============================================================================
Note: RESOURCE USAGE SYSCALLS
Note: ============================================================================

Process called "SYS_GETRUSAGE" returns Integer:
    Note: getrusage - get resource usage
    Return 117
End Process

Process called "SYS_GETPRIORITY" returns Integer:
    Note: getpriority - get program scheduling priority
    Return 100
End Process

Process called "SYS_SETPRIORITY" returns Integer:
    Note: setpriority - set program scheduling priority
    Return 96
End Process

Note: ============================================================================
Note: PROFILING AND DEBUGGING SYSCALLS
Note: ============================================================================

Process called "SYS_PROFIL" returns Integer:
    Note: profil - control process profiling
    Return 44
End Process

Process called "SYS_KTRACE" returns Integer:
    Note: ktrace - process tracing
    Return 45
End Process

Process called "SYS_PTRACE" returns Integer:
    Note: ptrace - process trace
    Return 26
End Process

Note: ============================================================================
Note: GENERIC SYSCALL WRAPPERS
Note: ============================================================================
Note: Darwin ARM64 syscall convention:
Note: - X16 = syscall number (DIFFERENT from Linux which uses X8!)
Note: - X0-X7 = arguments 1-8
Note: - Stack = arguments 9+ (16-byte aligned)
Note: - Return value in X0

Process called "syscall_0" takes syscall_number as Integer returns Integer:
    Note: Darwin ARM64 syscall with 0 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16 (Darwin uses X16, not X8!)
        ldr x16, [fp, #-8]

        // Execute syscall (Darwin uses svc #0x80 for BSD syscalls)
        svc #0x80

        // Store result from X0
        str x0, [fp, #-16]
    End Assembly
    Return result
End Process

Process called "syscall_1" takes syscall_number as Integer, arg1 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 1 argument
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load argument 1 into X0
        ldr x0, [fp, #-16]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-24]
    End Assembly
    Return result
End Process

Process called "syscall_2" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 2 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load argument 1 into X0
        ldr x0, [fp, #-16]

        // Load argument 2 into X1
        ldr x1, [fp, #-24]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-32]
    End Assembly
    Return result
End Process

Process called "syscall_3" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 3 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-3 into X0-X2
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-40]
    End Assembly
    Return result
End Process

Process called "syscall_4" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 4 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-4 into X0-X3
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]
        ldr x3, [fp, #-40]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-48]
    End Assembly
    Return result
End Process

Process called "syscall_5" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 5 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-5 into X0-X4
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]
        ldr x3, [fp, #-40]
        ldr x4, [fp, #-48]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-56]
    End Assembly
    Return result
End Process

Process called "syscall_6" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 6 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-6 into X0-X5
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]
        ldr x3, [fp, #-40]
        ldr x4, [fp, #-48]
        ldr x5, [fp, #-56]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-64]
    End Assembly
    Return result
End Process

Process called "syscall_7" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer, arg7 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 7 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-7 into X0-X6
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]
        ldr x3, [fp, #-40]
        ldr x4, [fp, #-48]
        ldr x5, [fp, #-56]
        ldr x6, [fp, #-64]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-72]
    End Assembly
    Return result
End Process

Process called "syscall_8" takes syscall_number as Integer, arg1 as Integer, arg2 as Integer, arg3 as Integer, arg4 as Integer, arg5 as Integer, arg6 as Integer, arg7 as Integer, arg8 as Integer returns Integer:
    Note: Darwin ARM64 syscall with 8 arguments
    Let result be 0
    Inline Assembly:
        // Load syscall number into X16
        ldr x16, [fp, #-8]

        // Load arguments 1-8 into X0-X7
        ldr x0, [fp, #-16]
        ldr x1, [fp, #-24]
        ldr x2, [fp, #-32]
        ldr x3, [fp, #-40]
        ldr x4, [fp, #-48]
        ldr x5, [fp, #-56]
        ldr x6, [fp, #-64]
        ldr x7, [fp, #-72]

        // Execute syscall
        svc #0x80

        // Store result from X0
        str x0, [fp, #-80]
    End Assembly
    Return result
End Process

Note: ============================================================================
Note: HIGH-LEVEL BSD SYSCALL WRAPPERS
Note: ============================================================================

Process called "syscall_read" takes fd as Integer, buffer as Integer, count as Integer returns Integer:
    Note: Read from file descriptor
    Let syscall_num be SYS_READ()
    Return syscall_3(syscall_num, fd, buffer, count)
End Process

Process called "syscall_write" takes fd as Integer, buffer as Integer, count as Integer returns Integer:
    Note: Write to file descriptor
    Let syscall_num be SYS_WRITE()
    Return syscall_3(syscall_num, fd, buffer, count)
End Process

Process called "syscall_open" takes filename as Integer, flags as Integer, mode as Integer returns Integer:
    Note: Open a file
    Let syscall_num be SYS_OPEN()
    Return syscall_3(syscall_num, filename, flags, mode)
End Process

Process called "syscall_close" takes fd as Integer returns Integer:
    Note: Close a file descriptor
    Let syscall_num be SYS_CLOSE()
    Return syscall_1(syscall_num, fd)
End Process

Process called "syscall_exit" takes status as Integer returns Integer:
    Note: Exit process immediately
    Let syscall_num be SYS_EXIT()
    Return syscall_1(syscall_num, status)
End Process

Process called "syscall_mmap" takes addr as Integer, length as Integer, prot as Integer, flags as Integer, fd as Integer, offset as Integer returns Integer:
    Note: Map memory region
    Let syscall_num be SYS_MMAP()
    Return syscall_6(syscall_num, addr, length, prot, flags, fd, offset)
End Process

Process called "syscall_munmap" takes addr as Integer, length as Integer returns Integer:
    Note: Unmap memory region
    Let syscall_num be SYS_MUNMAP()
    Return syscall_2(syscall_num, addr, length)
End Process

Process called "syscall_mprotect" takes addr as Integer, length as Integer, prot as Integer returns Integer:
    Note: Change memory protection
    Let syscall_num be SYS_MPROTECT()
    Return syscall_3(syscall_num, addr, length, prot)
End Process

Process called "syscall_getpid" returns Integer:
    Note: Get process ID
    Let syscall_num be SYS_GETPID()
    Return syscall_0(syscall_num)
End Process

Process called "syscall_kill" takes pid as Integer, signal as Integer returns Integer:
    Note: Send signal to process
    Let syscall_num be SYS_KILL()
    Return syscall_2(syscall_num, pid, signal)
End Process

Note: ============================================================================
Note: BSD/POSIX CONSTANTS
Note: ============================================================================

Process called "O_RDONLY" returns Integer:
    Return 0
End Process

Process called "O_WRONLY" returns Integer:
    Return 1
End Process

Process called "O_RDWR" returns Integer:
    Return 2
End Process

Process called "O_CREAT" returns Integer:
    Return 512  Note: 0x200
End Process

Process called "O_TRUNC" returns Integer:
    Return 1024  Note: 0x400
End Process

Process called "O_APPEND" returns Integer:
    Return 8
End Process

Process called "PROT_NONE" returns Integer:
    Return 0
End Process

Process called "PROT_READ" returns Integer:
    Return 1
End Process

Process called "PROT_WRITE" returns Integer:
    Return 2
End Process

Process called "PROT_EXEC" returns Integer:
    Return 4
End Process

Process called "MAP_SHARED" returns Integer:
    Return 1
End Process

Process called "MAP_PRIVATE" returns Integer:
    Return 2
End Process

Process called "MAP_ANONYMOUS" returns Integer:
    Return 4096  Note: 0x1000 on Darwin (MAP_ANON)
End Process

Process called "MAP_FAILED" returns Integer:
    Return -1
End Process

Process called "STDIN_FILENO" returns Integer:
    Return 0
End Process

Process called "STDOUT_FILENO" returns Integer:
    Return 1
End Process

Process called "STDERR_FILENO" returns Integer:
    Return 2
End Process

Process called "SEEK_SET" returns Integer:
    Return 0
End Process

Process called "SEEK_CUR" returns Integer:
    Return 1
End Process

Process called "SEEK_END" returns Integer:
    Return 2
End Process

Note: ============================================================================
Note: HELPER FUNCTIONS
Note: ============================================================================

Process called "is_error" takes result as Integer returns Integer:
    Note: Check if syscall result indicates error
    Note: BSD syscalls return -1 on error, errno not used directly
    If result is less than 0:
        Return 1  Note: Error
    End If
    Return 0  Note: Success
End Process
