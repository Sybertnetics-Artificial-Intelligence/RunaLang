# Test case for destroy function issue

Let EXPR_TYPE be 0
Let EXPR_BINARY be 1
Let EXPR_BINARY_LEFT be 8
Let EXPR_BINARY_RIGHT be 16

Process called "memory_get_integer" takes ptr as Integer, offset as Integer returns Integer:
    Return 0
End Process

Process called "memory_get_pointer" takes ptr as Integer, offset as Integer returns Integer:
    Return 0
End Process

Process called "deallocate" takes ptr as Integer returns Integer:
    Return 0
End Process

Process called "string_destroy" takes str as Integer returns Integer:
    Return 0
End Process

Process called "expression_destroy" takes expr as Integer returns Integer:
    If expr is equal to 0:
        Return 0
    End If

    Let expr_type be memory_get_integer(expr, EXPR_TYPE)

    If expr_type is equal to EXPR_BINARY:
        expression_destroy(memory_get_pointer(expr, EXPR_BINARY_LEFT))
        expression_destroy(memory_get_pointer(expr, EXPR_BINARY_RIGHT))
    End If

    deallocate(expr)
    Return 0
End Process

Process called "main" takes argc as Integer, argv as Integer returns Integer:
    Return 0
End Process