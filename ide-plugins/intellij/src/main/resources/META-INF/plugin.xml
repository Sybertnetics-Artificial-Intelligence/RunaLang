<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.sybertnetics.runa</id>
    <name>Runa Language Support</name>
    <vendor email="support@sybertnetics.com" url="https://github.com/sybertneticsaisolutions/runa">Sybertnetics AI Solutions</vendor>
    
    <description><![CDATA[
        <h2>Runa Language Support</h2>
        <p>Comprehensive language support for Runa - the AI-first natural programming language designed for AI-to-AI communication.</p>
        
        <h3>Key Features:</h3>
        <ul>
            <li><strong>Natural Language Syntax:</strong> Complete support for Runa's pseudocode-like syntax</li>
            <li><strong>Mathematical Symbol Enforcement:</strong> Warnings when symbols are used outside mathematical contexts</li>
            <li><strong>Intelligent Code Completion:</strong> Context-aware completion for keywords, operators, and built-ins</li>
            <li><strong>Advanced Syntax Highlighting:</strong> Proper highlighting for natural language constructs</li>
            <li><strong>Error Detection:</strong> Real-time error detection with quick fixes</li>
            <li><strong>Code Formatting:</strong> Automatic formatting with proper indentation</li>
            <li><strong>File Templates:</strong> Quick start templates for common Runa patterns</li>
            <li><strong>Live Templates:</strong> Code snippets for rapid development</li>
            <li><strong>Structure View:</strong> Navigate through functions, types, and declarations</li>
            <li><strong>Compiler Integration:</strong> Build and run Runa programs directly from IDE</li>
        </ul>
        
        <h3>Runa Language Highlights:</h3>
        <ul>
            <li>Natural syntax: <code>Let variable be value</code></li>
            <li>Functions: <code>Process called "function name" that takes parameter as Type returns Type</code></li>
            <li>Control flow: <code>If condition:</code>, <code>For each item in collection:</code></li>
            <li>Natural operators: <code>plus</code>, <code>minus</code>, <code>multiplied by</code>, etc.</li>
            <li>Comments: <code>Note: single line</code> or <code>Note: ... :End Note</code> blocks</li>
        </ul>
        
        <p>Perfect for AI development, natural language programming, and systems requiring human-readable code.</p>
    ]]></description>
    
    <change-notes><![CDATA[
        <h3>Version 1.0.0</h3>
        <ul>
            <li>Initial release with full Runa language support</li>
            <li>Complete syntax highlighting for natural language constructs</li>
            <li>Intelligent code completion and IntelliSense</li>
            <li>Real-time error detection and quick fixes</li>
            <li>Mathematical symbol enforcement according to language specification</li>
            <li>File templates and live templates for rapid development</li>
            <li>Code formatting and structure view</li>
            <li>Integration with Runa compiler for build and run operations</li>
            <li>Brace matching, code folding, and navigation features</li>
        </ul>
    ]]></change-notes>
    
    <idea-version since-build="231" until-build="241.*"/>
    
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    
    <extensions defaultExtensionNs="com.intellij">
        <!-- File Type -->
        <fileType 
            name="Runa" 
            implementationClass="com.sybertnetics.runa.RunaFileType" 
            fieldName="INSTANCE" 
            language="Runa" 
            extensions="runa"/>
            
        <!-- Language -->
        <lang.parserDefinition 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaParserDefinition"/>
            
        <!-- Lexer -->
        <lang.syntaxHighlighterFactory 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaSyntaxHighlighterFactory"/>
            
        <!-- Color Settings Page -->
        <colorSettingsPage 
            implementation="com.sybertnetics.runa.RunaColorSettingsPage"/>
            
        <!-- Completion Contributor -->
        <completion.contributor 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaCompletionContributor"/>
            
        <!-- Annotator for error highlighting -->
        <annotator 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaAnnotator"/>
            
        <!-- Formatter -->
        <lang.formatter 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaFormattingModelBuilder"/>
            
        <!-- Code Style Settings -->
        <codeStyleSettingsProvider 
            implementation="com.sybertnetics.runa.RunaCodeStyleSettingsProvider"/>
            
        <!-- Language Code Style Settings -->
        <langCodeStyleSettingsProvider 
            implementation="com.sybertnetics.runa.RunaLanguageCodeStyleSettingsProvider"/>
            
        <!-- Brace Matcher -->
        <lang.braceMatcher 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaBraceMatcher"/>
            
        <!-- Commenter -->
        <lang.commenter 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaCommenter"/>
            
        <!-- Find Usages Provider -->
        <lang.findUsagesProvider 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaFindUsagesProvider"/>
            
        <!-- Structure View Factory -->
        <lang.psiStructureViewFactory 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaStructureViewFactory"/>
            
        <!-- File Template -->
        <internalFileTemplate name="Runa File"/>
        
        <!-- Live Templates -->
        <defaultLiveTemplates file="/liveTemplates/Runa.xml"/>
        <liveTemplateContext implementation="com.sybertnetics.runa.RunaTemplateContextType"/>
        
        <!-- Documentation Provider -->
        <lang.documentationProvider 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaDocumentationProvider"/>
            
        <!-- Quick Fix Provider -->
        <codeInsight.lineMarkerProvider 
            language="Runa" 
            implementationClass="com.sybertnetics.runa.RunaLineMarkerProvider"/>
    </extensions>
    
    <actions>
        <!-- File creation action -->
        <action id="Runa.NewFile" 
                class="com.sybertnetics.runa.actions.CreateRunaFileAction" 
                text="Runa File" 
                description="Create new Runa file"
                icon="RunaIcons.FILE">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFile"/>
        </action>
        
        <!-- Compile action -->
        <action id="Runa.Compile" 
                class="com.sybertnetics.runa.actions.CompileRunaFileAction" 
                text="Compile Runa File" 
                description="Compile the current Runa file"
                icon="AllIcons.Actions.Compile">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift B"/>
        </action>
        
        <!-- Run action -->
        <action id="Runa.Run" 
                class="com.sybertnetics.runa.actions.RunRunaFileAction" 
                text="Run Runa File" 
                description="Run the current Runa file"
                icon="AllIcons.Actions.Execute">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Runa.Compile"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="Runa.Compile"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl F5"/>
        </action>
        
        <!-- Convert Symbols to Words action -->
        <action id="Runa.ConvertSymbolsToWords" 
                class="com.sybertnetics.runa.actions.ConvertSymbolsToWordsAction" 
                text="Convert Mathematical Symbols to Words" 
                description="Convert mathematical symbols to natural language according to Runa specification"
                icon="AllIcons.Actions.RefactoringBulb">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Runa.Run"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift C"/>
        </action>
        
        <!-- Format action -->
        <action id="Runa.Format" 
                class="com.sybertnetics.runa.actions.FormatRunaFileAction" 
                text="Format Runa Code" 
                description="Format the current Runa file"
                icon="AllIcons.Actions.PrettyPrint">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Runa.ConvertSymbolsToWords"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt L"/>
        </action>
    </actions>
    
    <applicationListeners>
        <listener class="com.sybertnetics.runa.RunaProjectListener"
                  topic="com.intellij.openapi.project.ProjectManagerListener"/>
    </applicationListeners>
</idea-plugin>
