Note:
Runa LSP Types: Protocol Data Structures

This module defines all the data types and structures used by the Language Server Protocol.
These types correspond to the LSP specification and provide type safety for LSP communication.

Key Types:
- LSP Request/Response structures
- Document and position types
- Diagnostic and completion types
- Server and client capability types
:End Note

Note: LSP Protocol Types
Type LSPRequest is Dictionary with:
    jsonrpc as String
    id as Integer
    method as String
    params as Any

Type LSPResponse is Dictionary with:
    jsonrpc as String
    id as Integer
    result as Any
    error as Optional[LSPError]

Type LSPError is Dictionary with:
    code as Integer
    message as String
    data as Optional[Any]

Type LSPNotification is Dictionary with:
    jsonrpc as String
    method as String
    params as Any

Note: Document and Position Types
Type Position is Dictionary with:
    line as Integer
    character as Integer

Type Range is Dictionary with:
    start as Position
    end as Position

Type Location is Dictionary with:
    uri as String
    range as Range

Type TextDocumentIdentifier is Dictionary with:
    uri as String

Type TextDocumentItem is Dictionary with:
    uri as String
    language_id as String
    version as Integer
    text as String

Type VersionedTextDocumentIdentifier is Dictionary with:
    uri as String
    version as Integer

Type TextDocumentContentChangeEvent is Dictionary with:
    range as Optional[Range]
    range_length as Optional[Integer]
    text as String

Note: Diagnostic Types
Type Diagnostic is Dictionary with:
    range as Range
    severity as DiagnosticSeverity
    code as Optional[String]
    source as Optional[String]
    message as String
    tags as Optional[List[DiagnosticTag]]
    related_information as Optional[List[DiagnosticRelatedInformation]]

Type DiagnosticSeverity is Integer with:
    Error as 1
    Warning as 2
    Information as 3
    Hint as 4

Type DiagnosticTag is Integer with:
    Unnecessary as 1
    Deprecated as 2

Type DiagnosticRelatedInformation is Dictionary with:
    location as Location
    message as String

Note: Completion Types
Type CompletionItem is Dictionary with:
    label as String
    kind as CompletionItemKind
    tags as Optional[List[CompletionItemTag]]
    detail as Optional[String]
    documentation as Optional[String | MarkupContent]
    deprecated as Optional[Boolean]
    preselect as Optional[Boolean]
    sort_text as Optional[String]
    filter_text as Optional[String]
    insert_text as Optional[String]
    insert_text_format as Optional[InsertTextFormat]
    insert_text_mode as Optional[InsertTextMode]
    text_edit as Optional[TextEdit]
    additional_text_edits as Optional[List[TextEdit]]
    commit_characters as Optional[List[String]]
    command as Optional[Command]
    data as Optional[Any]

Type CompletionItemKind is Integer with:
    Text as 1
    Method as 2
    Function as 3
    Constructor as 4
    Field as 5
    Variable as 6
    Class as 7
    Interface as 8
    Module as 9
    Property as 10
    Unit as 11
    Value as 12
    Enum as 13
    Keyword as 14
    Snippet as 15
    Color as 16
    File as 17
    Reference as 18
    Folder as 19
    EnumMember as 20
    Constant as 21
    Struct as 22
    Event as 23
    Operator as 24
    TypeParameter as 25

Type CompletionItemTag is Integer with:
    Deprecated as 1

Type InsertTextFormat is Integer with:
    PlainText as 1
    Snippet as 2

Type InsertTextMode is Integer with:
    AsIs as 1
    AdjustIndentation as 2

Type TextEdit is Dictionary with:
    range as Range
    new_text as String

Note: Hover Types
Type Hover is Dictionary with:
    contents as HoverContent
    range as Optional[Range]

Type HoverContent is String | MarkupContent | List[String | MarkupContent]

Type MarkupContent is Dictionary with:
    kind as MarkupKind
    value as String

Type MarkupKind is String with:
    PlainText as "plaintext"
    Markdown as "markdown"

Note: Symbol Types
Type DocumentSymbol is Dictionary with:
    name as String
    detail as Optional[String]
    kind as SymbolKind
    tags as Optional[List[SymbolTag]]
    deprecated as Optional[Boolean]
    range as Range
    selection_range as Range
    children as Optional[List[DocumentSymbol]]

Type SymbolKind is Integer with:
    File as 1
    Module as 2
    Namespace as 3
    Package as 4
    Class as 5
    Method as 6
    Property as 7
    Field as 8
    Constructor as 9
    Enum as 10
    Interface as 11
    Function as 12
    Variable as 13
    Constant as 14
    String as 15
    Number as 16
    Boolean as 17
    Array as 18
    Object as 19
    Key as 20
    Null as 21
    EnumMember as 22
    Struct as 23
    Event as 24
    Operator as 25
    TypeParameter as 26

Type SymbolTag is Integer with:
    Deprecated as 1

Note: Semantic Token Types
Type SemanticTokens is Dictionary with:
    result_id as Optional[String]
    data as List[Integer]

Type SemanticTokensLegend is Dictionary with:
    token_types as List[String]
    token_modifiers as List[String]

Note: Workspace Types
Type WorkspaceFolder is Dictionary with:
    uri as String
    name as String

Type ClientCapabilities is Dictionary with:
    workspace as Optional[WorkspaceClientCapabilities]
    text_document as Optional[TextDocumentClientCapabilities]
    experimental as Optional[Any]

Type WorkspaceClientCapabilities is Dictionary with:
    apply_edit as Optional[Boolean]
    workspace_edit as Optional[WorkspaceEditClientCapabilities]
    did_change_configuration as Optional[DidChangeConfigurationClientCapabilities]
    did_change_watched_files as Optional[DidChangeWatchedFilesClientCapabilities]
    symbol as Optional[WorkspaceSymbolClientCapabilities]
    execute_command as Optional[ExecuteCommandClientCapabilities]
    workspace_folders as Optional[Boolean]
    configuration as Optional[Boolean]
    semantic_tokens as Optional[SemanticTokensWorkspaceClientCapabilities]

Type TextDocumentClientCapabilities is Dictionary with:
    synchronization as Optional[TextDocumentSyncClientCapabilities]
    completion as Optional[CompletionClientCapabilities]
    hover as Optional[HoverClientCapabilities]
    signature_help as Optional[SignatureHelpClientCapabilities]
    declaration as Optional[DeclarationClientCapabilities]
    definition as Optional[DefinitionClientCapabilities]
    type_definition as Optional[TypeDefinitionClientCapabilities]
    implementation as Optional[ImplementationClientCapabilities]
    references as Optional[ReferenceClientCapabilities]
    document_highlight as Optional[DocumentHighlightClientCapabilities]
    document_symbol as Optional[DocumentSymbolClientCapabilities]
    code_action as Optional[CodeActionClientCapabilities]
    code_lens as Optional[CodeLensClientCapabilities]
    document_link as Optional[DocumentLinkClientCapabilities]
    document_color as Optional[DocumentColorClientCapabilities]
    document_formatting as Optional[DocumentFormattingClientCapabilities]
    document_range_formatting as Optional[DocumentRangeFormattingClientCapabilities]
    document_on_type_formatting as Optional[DocumentOnTypeFormattingClientCapabilities]
    rename as Optional[RenameClientCapabilities]
    publish_diagnostics as Optional[PublishDiagnosticsClientCapabilities]
    folding_range as Optional[FoldingRangeClientCapabilities]
    selection_range as Optional[SelectionRangeClientCapabilities]
    linked_editing_range as Optional[LinkedEditingRangeClientCapabilities]
    call_hierarchy as Optional[CallHierarchyClientCapabilities]
    semantic_tokens as Optional[SemanticTokensClientCapabilities]
    moniker as Optional[MonikerClientCapabilities]

Type ServerCapabilities is Dictionary with:
    text_document_sync as Optional[TextDocumentSyncOptions | TextDocumentSyncKind]
    completion_provider as Optional[CompletionOptions]
    hover_provider as Optional[Boolean | HoverOptions]
    signature_help_provider as Optional[SignatureHelpOptions]
    declaration_provider as Optional[Boolean | DeclarationOptions | DeclarationRegistrationOptions]
    definition_provider as Optional[Boolean | DefinitionOptions]
    type_definition_provider as Optional[Boolean | TypeDefinitionOptions | TypeDefinitionRegistrationOptions]
    implementation_provider as Optional[Boolean | ImplementationOptions | ImplementationRegistrationOptions]
    references_provider as Optional[Boolean | ReferenceOptions]
    document_highlight_provider as Optional[Boolean | DocumentHighlightOptions]
    document_symbol_provider as Optional[Boolean | DocumentSymbolOptions]
    code_action_provider as Optional[Boolean | CodeActionOptions]
    code_lens_provider as Optional[CodeLensOptions]
    document_link_provider as Optional[DocumentLinkOptions]
    document_color_provider as Optional[DocumentColorOptions | DocumentColorRegistrationOptions]
    document_formatting_provider as Optional[Boolean | DocumentFormattingOptions]
    document_range_formatting_provider as Optional[Boolean | DocumentRangeFormattingOptions]
    document_on_type_formatting_provider as Optional[DocumentOnTypeFormattingOptions]
    rename_provider as Optional[Boolean | RenameOptions]
    folding_range_provider as Optional[Boolean | FoldingRangeOptions | FoldingRangeRegistrationOptions]
    selection_range_provider as Optional[Boolean | SelectionRangeOptions | SelectionRangeRegistrationOptions]
    linked_editing_range_provider as Optional[Boolean | LinkedEditingRangeOptions | LinkedEditingRangeRegistrationOptions]
    call_hierarchy_provider as Optional[Boolean | CallHierarchyOptions | CallHierarchyRegistrationOptions]
    semantic_tokens_provider as Optional[SemanticTokensOptions | SemanticTokensRegistrationOptions]
    moniker_provider as Optional[Boolean | MonikerOptions | MonikerRegistrationOptions]
    workspace_symbol_provider as Optional[Boolean | WorkspaceSymbolOptions]
    workspace as Optional[WorkspaceOptions]
    experimental as Optional[Any]

Note: Utility Functions for Creating Default Capabilities
Process called "create_default_client_capabilities" returns ClientCapabilities:
    Note: Create default client capabilities
    Return ClientCapabilities with:
        workspace as WorkspaceClientCapabilities with:
            apply_edit as true
            workspace_edit as WorkspaceEditClientCapabilities with:
                document_changes as true
                resource_operations as list containing "create" and "rename" and "delete"
                failure_handling as "textOnlyTransactional"
            did_change_configuration as DidChangeConfigurationClientCapabilities with:
                dynamic_registration as true
            did_change_watched_files as DidChangeWatchedFilesClientCapabilities with:
                dynamic_registration as true
            symbol as WorkspaceSymbolClientCapabilities with:
                symbol_kind as SymbolKindSupport with:
                    value_set as list containing all SymbolKind values
                tag_support as TagSupport with:
                    value_set as list containing all SymbolTag values
            execute_command as ExecuteCommandClientCapabilities with:
                dynamic_registration as true
            workspace_folders as true
            configuration as true
            semantic_tokens as SemanticTokensWorkspaceClientCapabilities with:
                refresh_support as true
        text_document as TextDocumentClientCapabilities with:
            synchronization as TextDocumentSyncClientCapabilities with:
                dynamic_registration as true
                will_save as true
                will_save_wait_until as true
                did_save as true
            completion as CompletionClientCapabilities with:
                dynamic_registration as true
                completion_item as CompletionItemClientCapabilities with:
                    snippet_support as true
                    commit_characters_support as true
                    documentation_format as list containing "plaintext" and "markdown"
                    deprecated_support as true
                    preselect_support as true
                completion_item_kind as CompletionItemKindSupport with:
                    value_set as list containing all CompletionItemKind values
                context_support as true
            hover as HoverClientCapabilities with:
                dynamic_registration as true
                content_format as list containing "plaintext" and "markdown"
            signature_help as SignatureHelpClientCapabilities with:
                dynamic_registration as true
                signature_information as SignatureInformationClientCapabilities with:
                    documentation_format as list containing "plaintext" and "markdown"
                context_support as true
            declaration as DeclarationClientCapabilities with:
                dynamic_registration as true
                link_support as true
            definition as DefinitionClientCapabilities with:
                dynamic_registration as true
                link_support as true
            type_definition as TypeDefinitionClientCapabilities with:
                dynamic_registration as true
                link_support as true
            implementation as ImplementationClientCapabilities with:
                dynamic_registration as true
                link_support as true
            references as ReferenceClientCapabilities with:
                dynamic_registration as true
            document_highlight as DocumentHighlightClientCapabilities with:
                dynamic_registration as true
            document_symbol as DocumentSymbolClientCapabilities with:
                dynamic_registration as true
                symbol_kind as SymbolKindSupport with:
                    value_set as list containing all SymbolKind values
                hierarchical_document_symbol_support as true
                tag_support as TagSupport with:
                    value_set as list containing all SymbolTag values
                label_support as true
            code_action as CodeActionClientCapabilities with:
                dynamic_registration as true
                code_action_literal_support as CodeActionLiteralSupport with:
                    code_action_kind as CodeActionKindLiteralSupport with:
                        value_set as list containing common code action kinds
                is_preferred_support as true
                disabled_support as true
                data_support as true
                resolve_support as CodeActionResolveSupport with:
                    properties as list containing "edit" and "command"
            code_lens as CodeLensClientCapabilities with:
                dynamic_registration as true
            document_link as DocumentLinkClientCapabilities with:
                dynamic_registration as true
                tooltip_support as true
            document_color as DocumentColorClientCapabilities with:
                dynamic_registration as true
            document_formatting as DocumentFormattingClientCapabilities with:
                dynamic_registration as true
            document_range_formatting as DocumentRangeFormattingClientCapabilities with:
                dynamic_registration as true
            document_on_type_formatting as DocumentOnTypeFormattingClientCapabilities with:
                dynamic_registration as true
            rename as RenameClientCapabilities with:
                dynamic_registration as true
                prepare_support as true
                prepare_support_default_behavior as 1
                honors_change_annotations as true
            folding_range as FoldingRangeClientCapabilities with:
                dynamic_registration as true
                range_limit as 5000
                line_folding_only as true
                folding_range_kind as FoldingRangeKindSupport with:
                    value_set as list containing "comment" and "imports" and "region"
                folding_range as FoldingRangeSupport with:
                    collapsed_text as true
            selection_range as SelectionRangeClientCapabilities with:
                dynamic_registration as true
            linked_editing_range as LinkedEditingRangeClientCapabilities with:
                dynamic_registration as true
            call_hierarchy as CallHierarchyClientCapabilities with:
                dynamic_registration as true
            semantic_tokens as SemanticTokensClientCapabilities with:
                dynamic_registration as true
                requests as SemanticTokensRequests with:
                    range as true
                    full as true
                token_types as list containing common semantic token types
                token_modifiers as list containing common semantic token modifiers
                formats as list containing "relative"
                overlapping_token_support as true
                multiline_token_support as true
                server_cancel_support as true
                augments_syntax_tokens as true
            moniker as MonikerClientCapabilities with:
                dynamic_registration as true
        experimental as None

Process called "create_default_server_capabilities" returns ServerCapabilities:
    Note: Create default server capabilities
    Return ServerCapabilities with:
        text_document_sync as TextDocumentSyncOptions with:
            open_close as true
            change as 2  Note: Incremental
            will_save as true
            will_save_wait_until as true
            save as SaveOptions with:
                include_text as false
        completion_provider as CompletionOptions with:
            resolve_provider as true
            trigger_characters as list containing " " and "." and "(" and "[" and "\""
        hover_provider as true
        signature_help_provider as SignatureHelpOptions with:
            trigger_characters as list containing "(" and ","
            retrigger_characters as list containing ")"
        definition_provider as true
        references_provider as true
        document_highlight_provider as true
        document_symbol_provider as DocumentSymbolOptions with:
            label as "Runa"
        code_action_provider as CodeActionOptions with:
            code_action_kinds as list containing common code action kinds
            resolve_provider as true
        document_formatting_provider as true
        document_range_formatting_provider as true
        rename_provider as RenameOptions with:
            prepare_provider as true
        folding_range_provider as true
        selection_range_provider as true
        semantic_tokens_provider as SemanticTokensOptions with:
            legend as SemanticTokensLegend with:
                token_types as list containing common semantic token types
                token_modifiers as list containing common semantic token modifiers
            range as true
            full as true
        workspace_symbol_provider as true
        workspace as WorkspaceOptions with:
            workspace_folders as WorkspaceFoldersServerCapabilities with:
                supported as true
                change_notifications as true
        experimental as None

Note: Additional Support Types
Type SymbolKindSupport is Dictionary with:
    value_set as List[SymbolKind]

Type TagSupport is Dictionary with:
    value_set as List[SymbolTag]

Type CompletionItemKindSupport is Dictionary with:
    value_set as List[CompletionItemKind]

Type CompletionItemClientCapabilities is Dictionary with:
    snippet_support as Boolean
    commit_characters_support as Boolean
    documentation_format as List[MarkupKind]
    deprecated_support as Boolean
    preselect_support as Boolean

Type CompletionItemKindSupport is Dictionary with:
    value_set as List[CompletionItemKind]

Type HoverClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    content_format as List[MarkupKind]

Type SignatureInformationClientCapabilities is Dictionary with:
    documentation_format as List[MarkupKind]

Type DeclarationClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    link_support as Boolean

Type DefinitionClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    link_support as Boolean

Type TypeDefinitionClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    link_support as Boolean

Type ImplementationClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    link_support as Boolean

Type ReferenceClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentHighlightClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentSymbolClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    symbol_kind as SymbolKindSupport
    hierarchical_document_symbol_support as Boolean
    tag_support as TagSupport
    label_support as Boolean

Type CodeActionLiteralSupport is Dictionary with:
    code_action_kind as CodeActionKindLiteralSupport

Type CodeActionKindLiteralSupport is Dictionary with:
    value_set as List[String]

Type CodeActionResolveSupport is Dictionary with:
    properties as List[String]

Type DocumentFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentRangeFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentOnTypeFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type RenameClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    prepare_support as Boolean
    prepare_support_default_behavior as Integer
    honors_change_annotations as Boolean

Type FoldingRangeKindSupport is Dictionary with:
    value_set as List[String]

Type FoldingRangeSupport is Dictionary with:
    collapsed_text as Boolean

Type SemanticTokensRequests is Dictionary with:
    range as Boolean
    full as Boolean

Type WorkspaceEditClientCapabilities is Dictionary with:
    document_changes as Boolean
    resource_operations as List[String]
    failure_handling as String

Type DidChangeConfigurationClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DidChangeWatchedFilesClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type WorkspaceSymbolClientCapabilities is Dictionary with:
    symbol_kind as SymbolKindSupport
    tag_support as TagSupport

Type ExecuteCommandClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type SemanticTokensWorkspaceClientCapabilities is Dictionary with:
    refresh_support as Boolean

Type TextDocumentSyncClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    will_save as Boolean
    will_save_wait_until as Boolean
    did_save as Boolean

Type CompletionClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    completion_item as CompletionItemClientCapabilities
    completion_item_kind as CompletionItemKindSupport
    context_support as Boolean

Type SignatureHelpClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    signature_information as SignatureInformationClientCapabilities
    context_support as Boolean

Type ReferenceClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentHighlightClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentSymbolClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    symbol_kind as SymbolKindSupport
    hierarchical_document_symbol_support as Boolean
    tag_support as TagSupport
    label_support as Boolean

Type CodeActionClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    code_action_literal_support as CodeActionLiteralSupport
    is_preferred_support as Boolean
    disabled_support as Boolean
    data_support as Boolean
    resolve_support as CodeActionResolveSupport

Type CodeLensClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentLinkClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    tooltip_support as Boolean

Type DocumentColorClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentRangeFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type DocumentOnTypeFormattingClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type RenameClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    prepare_support as Boolean
    prepare_support_default_behavior as Integer
    honors_change_annotations as Boolean

Type FoldingRangeClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    range_limit as Integer
    line_folding_only as Boolean
    folding_range_kind as FoldingRangeKindSupport
    folding_range as FoldingRangeSupport

Type SelectionRangeClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type LinkedEditingRangeClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type CallHierarchyClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type SemanticTokensClientCapabilities is Dictionary with:
    dynamic_registration as Boolean
    requests as SemanticTokensRequests
    token_types as List[String]
    token_modifiers as List[String]
    formats as List[String]
    overlapping_token_support as Boolean
    multiline_token_support as Boolean
    server_cancel_support as Boolean
    augments_syntax_tokens as Boolean

Type MonikerClientCapabilities is Dictionary with:
    dynamic_registration as Boolean

Type TextDocumentSyncOptions is Dictionary with:
    open_close as Boolean
    change as Integer
    will_save as Boolean
    will_save_wait_until as Boolean
    save as SaveOptions

Type SaveOptions is Dictionary with:
    include_text as Boolean

Type CompletionOptions is Dictionary with:
    resolve_provider as Boolean
    trigger_characters as List[String]

Type SignatureHelpOptions is Dictionary with:
    trigger_characters as List[String]
    retrigger_characters as List[String]

Type DocumentSymbolOptions is Dictionary with:
    label as String

Type CodeActionOptions is Dictionary with:
    code_action_kinds as List[String]
    resolve_provider as Boolean

Type RenameOptions is Dictionary with:
    prepare_provider as Boolean

Type SemanticTokensOptions is Dictionary with:
    legend as SemanticTokensLegend
    range as Boolean
    full as Boolean

Type WorkspaceFoldersServerCapabilities is Dictionary with:
    supported as Boolean
    change_notifications as Boolean

Type WorkspaceOptions is Dictionary with:
    workspace_folders as WorkspaceFoldersServerCapabilities

Type Command is Dictionary with:
    title as String
    command as String
    arguments as Optional[List[Any]] 